---
title: Dockeræ•™ç¨‹
date: 2024-10-03
path: /wiki/docker-tutorial
---


## ç®€ä»‹
### ğŸ³ ä»€ä¹ˆæ˜¯ Dockerï¼Ÿ
Docker æ˜¯ä¸€ä¸ªå¼€æºçš„ **åº”ç”¨å®¹å™¨å¼•æ“** ï¼Œå¯ä»¥è®©å¼€å‘è€…å°†åº”ç”¨å’Œå…¶æ‰€æœ‰ä¾èµ–æ‰“åŒ…æˆä¸€ä¸ªâ€œå®¹å™¨â€ï¼Œ**ä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œã€‚**

â€œ**ä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œ**â€ä¹Ÿå°±æ˜¯è¯´ï¼š

1.  **ä¹‹å‰ï¼š**

ä¹‹å‰æƒ³è·‘ROS2+OpenCV+CUDA+CuDNNï¼Œæˆ‘éœ€è¦åœ¨ä¸€å°ç”µè„‘ä¸Šä¸€ä¸ªä¸€ä¸ªç¯å¢ƒçš„å®‰è£…é…ç½®ï¼Œå¦‚æœæˆ‘è¿˜è¦åœ¨å¦ä¸€å°ç”µè„‘ä¸Šè·‘è¿™ä¸ªï¼Œä¹Ÿéœ€è¦æŠŠç¬¬äºŒå°ç”µè„‘ä¹Ÿè¿™æ ·é…ç½®ä¸€éã€‚å¦‚æœæˆ‘çš„ç³»ç»Ÿç¯å¢ƒå´©äº†ï¼Œéœ€è¦é‡è£…ç³»ç»Ÿäº†ï¼Œé‡è£…å®ŒååˆåŒå’å•è¦å†æ¥ä¸€éé…ç½®è¿‡ç¨‹ï¼Œå¾ˆéº»çƒ¦ã€‚

2.  **ä½¿ç”¨dockeråï¼š**

ï¼ˆdockeré•œåƒå’Œdockerå®¹å™¨çš„æ¦‚å¿µåœ¨ä¸‹ä¸‹ä¸‹é¢ï¼Œä¸‹é¢è¿™æ®µè¯é‡Œçœ‹åˆ°é•œåƒå’Œå®¹å™¨çš„æ¦‚å¿µå…ˆæ¥å—å°±è¡Œã€‚ï¼‰

æˆ‘åªéœ€è¦åœ¨ç”µè„‘ä¸Šç”¨dockeré…ç½®ä¸€éè¿™ä¸ªROS2+OpenCV+CUDA+CuDNNç¯å¢ƒï¼Œç„¶åç”¨dockerç”Ÿæˆä¸€ä¸ªé•œåƒï¼ŒæŠŠè¿™ä¸ªé•œåƒæ‰“åŒ…å¥½ã€‚ä»¥ååœ¨ä»»ä½•ä¸€å°ç”µè„‘ä¸Šï¼Œæˆ‘éƒ½å¯ä»¥ç›´æ¥ç”¨è¿™ä¸ªé•œåƒç”Ÿæˆä¸€ä¸ªå®¹å™¨ï¼Œè€Œè¿™ä¸ªå®¹å™¨å†…å°±åŒ…å«äº†æˆ‘æ‰€éœ€è¦çš„ROS2+OpenCV+CUDA+CuDNNç¯å¢ƒï¼Œå¦‚æœæˆ‘çš„å®¹å™¨ç¯å¢ƒå´©äº†ï¼Œæˆ‘åªéœ€è¦æŠŠåæ‰çš„å®¹å™¨åˆ æ‰ï¼Œé‡æ–°ç”±é•œåƒå†ç”Ÿæˆä¸€ä¸ªæ–°çš„å®¹å™¨å³å¯ã€‚åªéœ€è¦é…ç½®ä¸€æ¬¡ï¼Œä»¥åéƒ½å¯ä»¥ä¸€é”®å®‰è£…è¿™ä¸ªç¯å¢ƒã€‚

### ğŸ“¦ å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ
*   ä¼ ç»Ÿæ–¹å¼ï¼šè½¯ä»¶è¿è¡Œéœ€è¦åœ¨ä¸åŒç³»ç»Ÿä¸Šå®‰è£…å„ç§åº“ã€é…ç½®ç¯å¢ƒï¼Œå¾ˆéº»çƒ¦ã€‚

*   Dockeræ–¹å¼ï¼šæ‰“åŒ…æˆâ€œå®¹å™¨â€ï¼Œç¯å¢ƒå’Œåº”ç”¨ä¸€èµ·å°è£…ï¼Œ **æ— è®ºåœ¨å“ªè¿è¡Œéƒ½ä¸€æ ·ç¨³å®š** ã€‚

### ğŸ”§ Docker çš„å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ
| æ¦‚å¿µ | è§£é‡Š |
|:---|:---|
| é•œåƒ | Imageï¼Œè¿è¡Œå®¹å™¨çš„æ¨¡æ¿ï¼Œåƒæ˜¯ä¸€ä¸ªåº”ç”¨å¿«ç…§ |
| å®¹å™¨ | Containerï¼Œè¿è¡Œä¸­çš„é•œåƒå®ä¾‹ï¼Œæœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œç­‰ |
| Dockerfile | æ„å»ºé•œåƒçš„è„šæœ¬ï¼Œå†™æ˜å®‰è£…å“ªäº›åŒ…ã€è®¾ç½®å“ªäº›ç¯å¢ƒå˜é‡ç­‰ |
| ä»“åº“ | Registryï¼Œå­˜æ”¾é•œåƒçš„åœ°æ–¹ï¼Œæ¯”å¦‚ Docker Hub |

æŠ½è±¡åŒ–ç†è§£:

Dockeré•œåƒâ‰ˆC++ç±»

Dockerå®¹å™¨â‰ˆC++ç±»å®ä¾‹(å³å¯¹è±¡)

å½¢è±¡åŒ–ç†è§£: é•œåƒå¯ä»¥ç±»ä¼¼äºç»™ç”µè„‘è£…ç³»ç»Ÿçš„isoé•œåƒæ–‡ä»¶ã€‚ å®¹å™¨å¯ä»¥ç±»ä¼¼äºå·²ç»è¢«è£…åˆ°ç”µè„‘ä¸Šçš„å¯ä»¥è¿è¡Œçš„ç³»ç»Ÿã€‚

æŠŠé•œåƒå˜ä¸ºå®¹å™¨æ—¶ï¼Œéœ€è¦ç”¨docker runå‘½ä»¤æ·»åŠ å¾ˆå¤šå‚æ•°ï¼Œè¿™ä¸ªå¯ä»¥ç†è§£ä½ è¿™ä¸ªç”µè„‘åˆ°åº•æœ‰å•¥ç¡¬ä»¶é…ç½®ã€‚

### ğŸ” ç±»æ¯”ç†è§£
| ä¼ ç»Ÿéƒ¨ç½² | Dockeréƒ¨ç½² |
|:---|:---|
| æ‰‹åŠ¨å®‰è£…ä¾èµ–ã€è°ƒè¯•ç‰ˆæœ¬ä¸ä¸€è‡´é—®é¢˜ | ä¸€æ¬¡æ‰“åŒ…ç¯å¢ƒå’Œä»£ç  |
| ç¨‹åºâ€œè£¸å¥”â€è·‘åœ¨ç³»ç»Ÿä¸Š | ç¨‹åºâ€œç©¿ç€å®¹å™¨â€éš”ç¦»è¿è¡Œ |
| å®¹æ˜“â€œåœ¨æˆ‘ç”µè„‘ä¸Šèƒ½è·‘â€ | ä¿è¯â€œæ— è®ºåœ¨å“ªéƒ½èƒ½è·‘â€ |

å°±åƒå¿«é€’åŒ…è£¹ï¼š **ä½ ä¸å†å…³å¿ƒå†…å®¹æ€ä¹ˆè¿é€ï¼Œå› ä¸ºåŒ…è£…å·²ç»å¸®ä½ åšå¥½äº†ä¸€åˆ‡éš”ç¦»ã€‚**

### âœ… Docker çš„æ ¸å¿ƒä¼˜åŠ¿
| ä¼˜åŠ¿ | è¯´æ˜ |
|:---|:---|
| è½»é‡çº§ | åŸºäºç³»ç»Ÿå†…æ ¸å…±äº«ï¼Œå¯åŠ¨é€Ÿåº¦å¿«ï¼Œå èµ„æºå°‘ |
| è·¨å¹³å° | ä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œï¼ˆWindowsã€Linuxã€macOS ä¸Šéƒ½ä¸€è‡´ï¼‰ |
| æ˜“äºè¿ç§»éƒ¨ç½² | åº”ç”¨å’Œç¯å¢ƒä¸€èµ·å°è£…ï¼Œä¸æ€•ä¾èµ–ä¸ä¸€è‡´ |
| æ˜“äºç‰ˆæœ¬æ§åˆ¶ | é•œåƒç‰ˆæœ¬å¯æ§ï¼Œæ”¯æŒå›æ»š |
| ç”Ÿæ€ä¸°å¯Œ | Docker Hub ä¸Šæœ‰æˆåƒä¸Šä¸‡çš„ç°æˆé•œåƒå¯ç”¨ |

1.  åœ¨Linuxä¸Šå¯ä»¥å‡ ä¹å®ç°æ— æ€§èƒ½æŸå¤±ã€‚

dockeré‡Œçš„å‘è¡Œç‰ˆå’Œæœ¬æœºå…±ç”¨Linuxå†…æ ¸ã€‚

CPUæŸè€—ä¸åˆ°1%ã€‚ å†…å­˜æ¥è¿‘åŸç”Ÿæ²¡æŸè€—ã€‚ ç¡¬ç›˜æŸè€—ä¸åˆ°2%ã€‚ ç½‘ç»œæ€§èƒ½æ¥è¿‘åŸç”Ÿæ²¡æœ‰æŸè€—ã€‚ æ˜¾å¡æŸè€—å°äº1%ã€‚

2.  å¯ä»¥å¿«é€Ÿéƒ¨ç½²åœ¨ç»å¤§å¤šæ•°Linuxå‘è¡Œç‰ˆ

ä½ æƒ³è·‘ROS2ï¼Œä¹‹å‰æ˜¯ä»…åœ¨Ubuntuä¸Šæ˜¯æ¯”è¾ƒå¥½éƒ¨ç½²çš„ï¼Œä½†æ˜¯ç°åœ¨ä½ å¯ä»¥ä½¿ç”¨ä»»æ„å‘è¡Œç‰ˆï¼Œæ¯”å¦‚Fedoraï¼ŒArchLinuxç­‰å‘è¡Œç‰ˆä¸Šä¹Ÿèƒ½é€šè¿‡dockerè·‘ROS2ã€‚

3.  é…ç½®ç¯å¢ƒç®€å•

ä¹‹å‰ä½ éœ€è¦åœ¨Ubuntuä¸ŠæŒ‰ç…§æ•™ç¨‹å®‰è£…ROS2ï¼ŒCUDAï¼ŒCuDNNï¼ŒOpenCV4ç­‰ç­‰ï¼Œä½†æ˜¯åªè¦ä½ ç”¨äº†Dockerï¼Œå¯ä»¥ç›´æ¥ç”¨docker pullå‘½ä»¤æ‹‰å–åˆ«äººé…ç½®å¥½çš„å¼€å‘ç¯å¢ƒï¼Œåªéœ€è¦ä¸€æ¡å‘½ä»¤ç›´é€šç½—é©¬ã€‚

ä½ ä»…ä»…åªéœ€è¦æŠŠä¸€ä¸ªå‘è¡Œç‰ˆæœ€åŸºç¡€çš„ä¸œè¥¿é…ç½®å¥½ï¼Œæ¯”å¦‚é‚£äº›ä»“åº“æ¢æºï¼Œè¾“å…¥æ³•ï¼Œæ˜¾å¡é©±åŠ¨ï¼ˆåªç”¨è®©æ˜¾å¡å·¥ä½œèµ·æ¥ï¼Œä¸ç”¨åœ¨æœ¬æœºé…ç½®CUDAå’ŒCuDNNï¼‰ç­‰ã€‚

4.  ç”Ÿæ€ä¸°å¯Œ

ç”Ÿæ€åŠå…¶ä¸°å¯Œï¼Œæœ‰å¾ˆå¤šä¸œè¥¿å³ä¾¿è‡ªå·±ä¸æ„å»ºï¼Œä¹Ÿèƒ½åœ¨dockerhubä¸Šæ‰¾åˆ°åˆ«äººæ„å»ºå¥½çš„é•œåƒï¼Œè‡ªå·±è¿ç¼–è¯‘éƒ½çœå»äº†ã€‚

æ¯”å¦‚ä¹‹å‰é…ç½®cudaå’Œcudnnçš„è¯ï¼Œéœ€è¦åœ¨æœ¬æœºå…ˆå®‰è£…è‹±ä¼Ÿè¾¾é©±åŠ¨ï¼Œå†å®‰è£…CUDAå’ŒCuDNNã€‚è€Œç°åœ¨ï¼Œæˆ‘ä»¬åªéœ€è¦æœ¬æœºå®‰è£…è‹±ä¼Ÿè¾¾é©±åŠ¨ï¼Œè‹±ä¼Ÿè¾¾å®˜æ–¹åœ¨DockerHubä¸Šæä¾›äº†CUDAå’ŒCUDNNçš„é•œåƒï¼Œä»–ä»¬å·²ç»ç¼–è¯‘å¥½äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹¿æ¥ç”¨ã€‚

### ğŸ“ å¸¸è§ Docker åº”ç”¨åœºæ™¯
*   æœ¬åœ°å¼€å‘ï¼šå¿«é€Ÿæ­å»ºå„ç§å¼€å‘ç¯å¢ƒï¼ˆå¦‚ Python + Jupyterã€ROS + Gazeboï¼‰

*   æµ‹è¯•éƒ¨ç½²ï¼šCI/CD ä¸­è‡ªåŠ¨æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²

*   å¾®æœåŠ¡æ¶æ„ï¼šæ¯ä¸ªæœåŠ¡ä¸€ä¸ªå®¹å™¨ï¼Œçµæ´»ç»„åˆ

*   ç§‘ç ”å·¥å…·å°è£…ï¼šå¤ç°åˆ«äººè®ºæ–‡ç¯å¢ƒï¼Œæˆ–å°è£…è‡ªå·±çš„é¡¹ç›®å‘ç»™ä»–äººä½¿ç”¨

## å®‰è£…Docker
### Linuxå®‰è£…Docker Engine(æ¨è)
Linuxåªéœ€è¦å®‰è£…Docker Engineå°±å¯ä»¥ï¼Œä¸è¦å®‰è£…docker desktopï¼Œé‚£ç©æ„æ˜¯ä¸“é—¨ç»™Macå’ŒWindowsç”¨çš„ã€‚

Linuxè·‘dockeræ€§èƒ½æŸå¤±å¾ˆä½ï¼Œè€ŒWindowså’ŒMacOSè·‘dockeræŸå¤±ç›¸å¯¹äºå¤§ä¸€äº›ã€‚

https://docs.docker.com/engine/install/

https://mirrors.bfsu.edu.cn/help/docker-ce/

#### Ubuntuï¼ˆAPTï¼‰
ä»¥ä¸‹å†…å®¹æ ¹æ® [å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/engine/install/ubuntu/) ä¿®æ”¹è€Œæ¥ã€‚

å¦‚æœä½ è¿‡å»å®‰è£…è¿‡ dockerï¼Œå…ˆåˆ æ‰ï¼š

```bash
for pkg in docker.io docker-doc docker-compose docker-compose-v2 podman-docker containerd runc; do sudo apt-get remove $pkg; done
```

é¦–å…ˆå®‰è£…ä¾èµ–å’ŒGPGï¼š

```bash
# Add Docker's official GPG key:
sudo apt-get update
sudo apt-get install ca-certificates curl
sudo install -m 0755 -d /etc/apt/keyrings
sudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
sudo chmod a+r /etc/apt/keyrings/docker.asc

# å¦‚æœä¸Šé¢è¿™è¡ŒæŠ¥é”™å°±å¼„ä¸‹é¢è¿™è¡Œ
sudo chmod a+r /etc/apt/keyrings/docker.gpg
```

ä¿¡ä»» Docker çš„ GPG å…¬é’¥å¹¶æ·»åŠ ä»“åº“ï¼š

```bash
# Add the repository to Apt sources:
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://mirrors.bfsu.edu.cn/docker-ce/linux/ubuntu \
  "$(. /etc/os-release && echo "$VERSION_CODENAME")" stable" | \
  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
```

æœ€åå®‰è£…

```bash
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

#### Fedoraï¼ˆDNF5ï¼‰
ä»¥ä¸‹å†…å®¹æ ¹æ® [å®˜æ–¹æ–‡æ¡£](https://docs.docker.com/engine/install/fedora/) ä¿®æ”¹è€Œæ¥ã€‚(å®˜æ–¹æ•™ç¨‹è¿˜æ˜¯DNF4,å¤ªè€äº†ï¼Œè¯·çœ‹ä¸‹æ–¹çš„æ•™ç¨‹)

å¦‚æœä½ ä¹‹å‰å®‰è£…è¿‡ dockerï¼Œè¯·å…ˆåˆ æ‰

```bash
sudo dnf remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-selinux \
                  docker-engine-selinux \
                  docker-engine
```

å®‰è£…ä¾èµ–ï¼Œä¸‹è½½ repo æ–‡ä»¶ï¼Œå¹¶æŠŠè½¯ä»¶ä»“åº“åœ°å€æ›¿æ¢ä¸ºé•œåƒç«™ï¼š

```bash
sudo dnf -y install dnf-plugins-core
sudo dnf config-manager addrepo --from-repofile=https://download.docker.com/linux/fedora/docker-ce.repo
sudo sed -i 's+https://download.docker.com+https://mirrors.bfsu.edu.cn/docker-ce+' /etc/yum.repos.d/docker-ce.repo
```

æœ€åå®‰è£…ï¼š

```bash
sudo dnf install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

### é…ç½®ç¯å¢ƒ
#### **æ£€æŸ¥ Docker æœåŠ¡çŠ¶æ€** ï¼š
åœ¨ Linux ä¸Šï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ Docker æœåŠ¡çš„çŠ¶æ€ï¼š

```bash
systemctl status docker
```

#### **å¯åŠ¨ Docker æœåŠ¡** ï¼š
å¦‚æœæœåŠ¡æ²¡æœ‰è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Docker æœåŠ¡ï¼š

```bash
sudo systemctl start docker
```

#### **è®¾ç½® Docker å¼€æœºè‡ªå¯** ï¼š
å¦‚æœä½ å¸Œæœ› Docker åœ¨æ¯æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œï¼Œå¯ä»¥å¯ç”¨å¼€æœºè‡ªå¯ï¼š

```bash
sudo systemctl enable docker
```

#### **å°†ç”¨æˆ·æ·»åŠ åˆ° `docker` ç»„** ï¼š
ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†å½“å‰ç”¨æˆ·æ·»åŠ åˆ° `docker` ç»„ï¼š

```bash
sudo usermod -aG docker $USER
```

#### **é€€å‡ºå¹¶é‡æ–°ç™»å½•** ï¼š
æ‰§è¡Œå®Œä¸Šè¿°å‘½ä»¤åï¼Œä½ éœ€è¦é€€å‡ºå½“å‰ä¼šè¯å¹¶é‡æ–°ç™»å½•ï¼Œæˆ–è€…è¿è¡Œä»¥ä¸‹å‘½ä»¤ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š

```bash
newgrp docker
```

#### **é‡æ–°å¯åŠ¨ Docker æœåŠ¡ï¼ˆå¦‚æœéœ€è¦ï¼‰** ï¼š
ç¡®ä¿ Docker æœåŠ¡æ­£åœ¨è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
sudo systemctl start docker
```

#### **é‡å¯ç”µè„‘åæ£€æŸ¥ Docker æœåŠ¡çŠ¶æ€** ï¼š
å…ˆé‡å¯ç”µè„‘ï¼Œæ¥ç€ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ Docker æœåŠ¡çš„çŠ¶æ€ï¼Œçœ‹çœ‹æ˜¯å¦æ­£å¸¸ï¼š

```bash
sudo reboot

systemctl status docker
```

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image1.webp)

### å®‰è£…Docker Desktopï¼ˆWinï¼ŒMacï¼‰
(Docker Desktopåœ¨Windowså’ŒMacOSä½¿ç”¨çš„æ˜¯è™šæ‹Ÿæœºï¼Œæ€§èƒ½æœ‰æŸå¤±ï¼Œåœ¨è¿™ä¿©ç³»ç»Ÿä¸Šå¯ä»¥ç”¨ï¼Œä½†æ˜¯ä½ éœ€è¦æ¥å—è¿™äº›æ€§èƒ½æŸå¤±ã€‚åœ¨Windowsä¸Šæ€§èƒ½æŸå¤±å’ŒWSL2çš„æŸå¤±å‡ ä¹ä¸€æ ·ï¼Œå› ä¸ºWindowsçš„docker desktopåŸºäºwsl2)

(Docker Desktopåœ¨Linuxä¸Šåªæ˜¯Docker Engineçš„ä¸€ä¸ªGUIç®¡ç†å·¥å…·ï¼Œä¾ç„¶é»˜è®¤ä½¿ç”¨Docker Engineå¼€å¯å®¹å™¨ï¼Œæ‰€ä»¥ä¾ç„¶å‡ ä¹æ²¡æœ‰æŸè€—ï¼Œè®¨åŒç”¨å‘½ä»¤è¡Œçš„å¯ä»¥è€ƒè™‘ä½¿ç”¨)

å®˜æ–¹ä¸‹è½½å®‰è£…:https://www.docker.com/

Windowsçš„Dockeræ˜¾å¡ç›´é€šä¸USBç›´é€š:

åœ¨Windowsä¸Šæƒ³Nvidiaæ˜¾å¡ç›´é€šçš„è¯ï¼Œéœ€è¦å…ˆå»DockerDesktopè®¾ç½®é‡Œå¼€å¯WSL2æ”¯æŒå¹¶å‹¾é€‰ä¸€ä¸ªwsl2çš„å‘è¡Œç‰ˆï¼Œæ¯”å¦‚Ubuntu22.04ï¼Œç´§æ¥ç€ï¼Œéœ€è¦è¿›å…¥wsl2çš„Ubuntu22.04ä¸­å®‰è£…NVIDIA Container Toolkitï¼Œæ•™ç¨‹åœ¨ä¸‹æ–¹ã€‚

åœ¨Windowsçš„Dockerä¸Šæƒ³è¦USBç›´é€šéœ€è¦å…ˆè®©wsl2ç›´é€šè¯¥usbï¼Œå†åœ¨docker runå‘½ä»¤å°†è¯¥è®¾å¤‡æ·»åŠ åˆ°dockerã€‚(å¦‚æœæŠŠwsl2æ‰€æœ‰è®¾å¤‡å…¨æŒ‚è½½åˆ°dockeräº†ï¼Œé‚£ä¹ˆåªéœ€è¦è®©usbç›´é€šwsl2)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image2.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image3.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image4.webp)

## Dockerç›´é€š
### USBç›´é€š
![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image5.webp)

1.  æ–¹æ³•ä¸€(ä¸æ˜¯å¾ˆæ¨èæ–°æ‰‹)ï¼š

åˆ›å»ºå®¹å™¨çš„æ—¶å€™æŠŠéœ€è¦çš„è®¾å¤‡åŠ åœ¨çº¢è‰²éƒ¨åˆ†è¿™é‡Œå³å¯ã€‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹æƒ³è¦çš„è®¾å¤‡çš„åå­—ã€‚

```bash
ls /dev
#ä¾‹å¦‚
--device=/dev/tty_USB0
```

2.  æ–¹æ³•äºŒ(ä¸ªäººæ›´åŠ æ¨èï¼Œä¸ç”¨é‡æ–°å†æŒ‚è½½äº†ï¼Œè™½ç„¶å®‰å…¨æ€§ä¼šé™ä½ï¼Œä½†æ˜¯åˆ«äººåˆ©ç”¨å®‰å…¨æƒé™èƒ½å¤Ÿæ”»å‡»ä½ çš„æ¦‚ç‡å¾ˆä½å¾ˆä½ï¼Œä¼ä¸šæœåŠ¡å™¨æ‰éœ€è¦æé˜²)ï¼š

```bash
--privileged
```

ç›´æ¥æ·»åŠ ä¸€è¡Œç»¿è‰²éƒ¨åˆ†ï¼Œç„¶åæ‰€æœ‰è®¾å¤‡éƒ½ä¼šè¢«æŒ‚è½½åˆ°dockeräº†ã€‚(çº¢è‰²éƒ¨åˆ†å°±ä¸ç”¨å†™äº†ï¼‰

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image6.webp)

### NVIDIAæ˜¾å¡ç›´é€š
NVIDIA Container Toolkitä½¿ç”¨æˆ· **èƒ½å¤Ÿæ„å»ºå’Œè¿è¡ŒGPUåŠ é€Ÿçš„å®¹å™¨** ã€‚è¯¥å·¥å…·åŒ…åŒ…æ‹¬ä¸€ä¸ªå®¹å™¨è¿è¡Œåº“å’Œå®ç”¨ç¨‹åºï¼Œç”¨äºè‡ªåŠ¨é…ç½®å®¹å™¨ä»¥åˆ©ç”¨NVIDIA GPUã€‚

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image7.webp)

https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html

#### å®‰è£…
ï¼ˆå°½é‡èƒ½çœ‹å®˜æ–¹å°±çœ‹å®˜æ–¹çš„ï¼Œå®‰è£…æ–¹å¼å¯èƒ½ä¼šæ›´æ–°ï¼‰

##### Ubuntu
1.  é…ç½®å­˜å‚¨åº“ å¹¶æ›´æ–°

```bash
curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \
  && curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \
    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \
    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list \
  && \
    sudo apt-get update
```

2.  å®‰è£…nvidia-docker2

```bash
sudo apt-get install -y nvidia-docker2
```

3.  ä½¿ç”¨nvidia-ctkå‘½ä»¤é…ç½®container runtime

```bash
sudo nvidia-ctk runtime configure --runtime=docker
```

4.  é‡å¯dockeræœåŠ¡:

```bash
sudo systemctl restart docker
```

##### Fedora
1.  Configure the production repository:

```bash
curl -s -L https://nvidia.github.io/libnvidia-container/stable/rpm/nvidia-container-toolkit.repo | \
sudo tee /etc/yum.repos.d/nvidia-container-toolkit.repo
```

2.  Optionally, configure the repository to use experimental packages:

```bash

# å¦‚æœæ˜¯RHELæˆ–è€…Rockyï¼ˆDNF4ï¼‰
sudo dnf config-manager --add-repo https://nvidia.github.io/libnvidia-container/stable/rpm/libnvidia-container.repo

# å¦‚æœæ˜¯Feodra41+ï¼ˆDNF5ï¼‰
sudo dnf config-manager addrepo --from-repofile=https://nvidia.github.io/libnvidia-container/stable/rpm/libnvidia-container.repo
```

3.  Install the NVIDIA Container Toolkit packages:

```bash

# å¦‚æœæ˜¯RHELæˆ–è€…Rocky
sudo dnf install -y nvidia-container-toolkit

# å¦‚æœæ˜¯Fedora
sudo dnf install -y nvidia-container-toolkit
```

4.  **å®‰è£…nvidia-docker2** ï¼š åœ¨Fedoraä¸Šä½¿ç”¨`dnf`è¿›è¡Œå®‰è£…ã€‚

```bash
sudo dnf install -y nvidia-docker2
```

5.  **ä½¿ç”¨nvidia-ctkå‘½ä»¤é…ç½®å®¹å™¨è¿è¡Œæ—¶** ï¼š è¿™ä¸ªå‘½ä»¤ç”¨äºé…ç½®NVIDIA Container Toolkitä¸Dockeré›†æˆã€‚å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
sudo nvidia-ctk runtime configure --runtime=docker
```

6.  **é‡å¯DockeræœåŠ¡** ï¼š å®Œæˆé…ç½®åï¼Œå¿…é¡»é‡å¯DockeræœåŠ¡ä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š

```bash
sudo systemctl restart docker
```

è¿™äº›æ­¥éª¤æ‰§è¡Œåï¼ŒDockerå°†ä½¿ç”¨NVIDIA Container Runtimeï¼Œå¹¶æ”¯æŒGPUåŠ é€Ÿçš„å®¹å™¨è¿è¡Œã€‚ä½ å¯ä»¥ä½¿ç”¨`nvidia-smi`å‘½ä»¤æ¥éªŒè¯å®¹å™¨ä¸­çš„NVIDIA GPUæ˜¯å¦å¯ç”¨ã€‚

#### æµ‹è¯•æ˜¯å¦å¯ç”¨
1.  **è¿è¡Œnvidia cuda å®¹å™¨è¿›è¡Œæµ‹è¯•** ï¼š

å¯ä»¥ä½¿ç”¨ä¸‹é¢æŒ‡ä»¤è¿›è¡Œæµ‹è¯•ï¼Œdockerä¼šè‡ªåŠ¨ä»nvidia/cudaæ‹‰å–11.0.3-base-ubuntu20.04é•œåƒï¼Œå¹¶åˆ›å»ºä¸€ä¸ªè¿è¡Œä¸€æ¬¡å³åˆ é™¤çš„å®¹å™¨ã€‚

```bash
sudo docker run --rm --gpus all nvidia/cuda:11.0.3-base-ubuntu20.04 nvidia-smi
```

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image8.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image9.webp)

### Dockeré…ç½®CUDAå’ŒCuDNN
å¦‚æœä½ ä¸éœ€è¦è‡ªå·±åˆ›å»ºDockeré•œåƒï¼Œç›´æ¥ä½¿ç”¨å­¦é•¿æˆ–è€…å…¶ä»–äººåˆ›å»ºå¥½çš„é•œåƒï¼Œåˆ™ä¸ç”¨çœ‹è¯¥ç« èŠ‚ï¼Œå®¹å™¨çš„CUDAå’ŒCuDNNæ˜¯å’Œæœ¬åœ°å®Œå…¨éš”ç¦»çš„ç¯å¢ƒï¼Œä½ æœ¬åœ°æœ‰æ²¡æœ‰CUDAéƒ½æ— æ‰€è°“ï¼Œä½†è‹±ä¼Ÿè¾¾é©±åŠ¨ç‰ˆæœ¬å¿…é¡»æ»¡è¶³CUDAçš„æœ€ä½ç‰ˆæœ¬è¦æ±‚ã€‚

ä¸‹é¢æ˜¯å¦‚æœä½ æƒ³è‡ªå·±åˆ›å»ºé•œåƒï¼Œåˆ™å¯ä»¥åœ¨å­¦ä¼šå¦‚ä½•åˆ›å»ºå®¹å™¨çš„é•œåƒåå†å›æ¥çœ‹æœ¬èŠ‚ï¼š

https://hub.docker.com/r/nvidia/cuda

åœ¨ä¸Šæ–¹è¿™ä¸ªç½‘ç«™ä¸­ï¼Œè‹±ä¼Ÿè¾¾éƒ½å¸®æˆ‘ä»¬é…ç½®å¥½äº†CUDAå’ŒCuDNNäº†ï¼Œæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦è‡ªå·±å»é…ç½®äº†ï¼Œæ¯”ä¼ ç»Ÿæ–¹å¼è¦ç®€å•å¤ªå¤šå¤ªå¤šäº†ã€‚

æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°å¯¹åº”çš„Dockeré•œåƒå½“åº•åŒ…å³å¯ã€‚

CUDAé•œåƒæœ‰ä¸‰ä¸ªç±»å‹ï¼Œå¦‚ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ç¼–è¯‘OpenCV4,é‚£ä¹ˆéœ€è¦ä½¿ç”¨develç‰ˆçš„CUDAã€‚

| é•œåƒç±»å‹ | é€‚ç”¨åœºæ™¯ | ç¤ºä¾‹æ ‡ç­¾ | å¤§å° |
|:---|:---|:---|:---|
| base | ä»…éœ€ CUDA è¿è¡Œæ—¶åº“ | 12.4.0-base-ubuntu22.04 | ~240MB |
| runtime | éƒ¨ç½²ç¼–è¯‘åçš„åº”ç”¨ï¼ˆå«æ•°å­¦åº“ï¼‰ | 12.4.0-runtime-ubuntu22.04 | ~2GB |
| devel | å¼€å‘ç¯å¢ƒï¼ˆå«ç¼–è¯‘å·¥å…·ï¼‰ | 12.4.0-devel-ubuntu22.04 | ~3GB |

æˆ‘ç¤ºä¾‹ä¸€ä¸ªï¼Œæ¯”å¦‚æˆ‘æƒ³ç”¨åœ¨Ubuntu24.04ä¸Šç”¨CUDA12.6å’ŒCuDNNï¼Œé‚£ä¹ˆå°±é€‰æ‹©`nvidia/cuda:12.6.0-cudnn-devel-ubuntu24.04`ã€‚è¿™ä¸ªé•œåƒæ—¢æœ‰CUDA-develä¹Ÿæœ‰CuDNNï¼Œè€Œä¸”è¿˜æ˜¯åŸºäºUbuntu24.04çš„ã€‚

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image10.webp)

åœ¨dockerfileé‡Œå°±å¯ä»¥å¼€å¤´è¿™ä¹ˆå†™ã€‚

```dockerfile

# åŸºäºNVIDIAå®˜æ–¹CUDA 12.6å’ŒCuDNNåŸºç¡€é•œåƒ
FROM nvidia/cuda:12.6.0-cudnn-devel-ubuntu24.04
```

### é…ç½®ä»¥å¤ªç½‘
```bash
--net=host \
```

å¯åŠ¨å‚æ•°é‡ŒåŠ ä¸Šè¿™è¡Œå³å¯ã€‚å…·ä½“åœ¨ä¸‹æ–¹ã€‚

## DockerHubæ¢æº
ï¼ˆDockerHubå·²äº2024å¹´5æœˆè¢«ğŸ‡¨ğŸ‡³å°æ€ï¼Œå„å¤§å›½å†…é•œåƒæºå‡å·²ä¸‹æ¶DockerHubé•œåƒæºï¼Œç›´æ¥æŒ‚æ¢¯ç”¨å®˜æ–¹æºå§ï¼‰

å„å¤§é•œåƒæºåªæœ‰Docker-Ceçš„é•œåƒåº“ï¼Œè¿™ä¸ªæ˜¯ç”¨æ¥å®‰è£…dockerçš„ï¼Œè€Œä¸æ˜¯dockerhubçš„é•œåƒæºã€‚

## dockerå®¹å™¨é‡Œçš„ç¨‹åºçš„å›¾å½¢ç•Œé¢å¼¹ä¸å‡ºæ¥
ï¼ˆç­‰ä½ æˆåŠŸåˆ›å»ºå®¹å™¨åï¼Œå†å›æ¥æè¿™ä¸ªæ“ä½œï¼‰

ä¸´æ—¶å…è®¸X11è®¿é—®ï¼š æ¯æ¬¡å¼€æœºåœ¨ä¸»æœºä¸Šè¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥å…è®¸X11è®¿é—®ï¼š(ä½†æ¯æ¬¡å¼€æœºéƒ½è¿è¡Œä¸€éå‘½ä»¤å¾ˆéº»çƒ¦ï¼Œå¯ä»¥å†™æˆè„šæœ¬å¼€æœºè‡ªå¯ï¼Œè¯¦è§ [è‡ªå¯åº”ç”¨ä¸è„šæœ¬](/wiki/linux-tutorial/#è‡ªå¯åº”ç”¨ä¸è„šæœ¬))

å‘½ä»¤å¦‚ä¸‹:
```bash
xhost +local:docker
```

è‡ªå¯è„šæœ¬å¦‚ä¸‹:
```bash
#!/bin/bash
# ç­‰å¾… X Server å°±ç»ªï¼ˆæœ€å¤šç­‰ 10 ç§’ï¼‰
for i in {1..10}; do
    if [ -n "$DISPLAY" ] && xset q >/dev/null 2>&1; then
        /usr/bin/xhost +local:docker
        exit 0
    fi
    sleep 1
done
```

æ•™ç¨‹éƒ¨åˆ†å¦‚ä¸‹ï¼š

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image11.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image12.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image13.webp)

## Dockerå‘½ä»¤å­¦ä¹ 
### å‚è€ƒæ–‡æ¡£
https://www.runoob.com/docker/docker-tutorial.html

### å¸¸ç”¨å‘½ä»¤
å¸¸ç”¨çš„æ ‡çº¢äº†ï¼Œå¶å°”ç”¨çš„æ ‡ç»¿äº†ï¼Œå…¶ä»–äº†è§£å°±è¡Œã€‚

| å‘½ä»¤ | æè¿° | ç¤ºä¾‹ |
|:---|:---|:---|
| docker run | åˆ›å»ºå¹¶å¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨ã€‚ | docker run -it ubuntu bash |
| docker build | é€šè¿‡æŒ‡å®šçš„ Dockerfile åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚ | docker build -t myimage . |
| docker pull | ä» Docker ä»“åº“æ‹‰å–é•œåƒã€‚ | docker pull ubuntu |
| docker push | å°†æœ¬åœ°é•œåƒæ¨é€åˆ° Docker ä»“åº“ã€‚ | docker push myimage |
| docker stop | åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚ | docker stop container_id |
| docker start | å¯åŠ¨ä¸€ä¸ªå·²ç»å­˜åœ¨çš„å®¹å™¨ã€‚ | docker start container_id |
| docker restart | é‡æ–°å¯åŠ¨å®¹å™¨ã€‚ | docker restart container_id |
| docker ps | åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚ | docker ps |
| docker rm | åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªåœæ­¢çš„å®¹å™¨ã€‚ | docker rm container_id |
| docker exec | åœ¨ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ã€‚ | docker exec -it container_id bash |
| docker logs | æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—è¾“å‡ºã€‚ | docker logs container_id |
| docker images | åˆ—å‡ºæœ¬åœ°æ‰€æœ‰é•œåƒã€‚ | docker images |
| docker rmi | åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒã€‚ | docker rmi myimage |
| docker network | ç®¡ç† Docker ç½‘ç»œã€‚ | docker network ls |
| docker volume | ç®¡ç† Docker æ•°æ®å·ã€‚ | docker volume ls |
| docker-compose up | å¯åŠ¨ docker-compose.yml ä¸­å®šä¹‰çš„æ‰€æœ‰æœåŠ¡ã€‚ | docker-compose up |
| docker-compose down | åœæ­¢å¹¶ç§»é™¤ docker-compose.yml ä¸­å®šä¹‰çš„æ‰€æœ‰æœåŠ¡åŠå…¶ç›¸å…³èµ„æºã€‚ | docker-compose down |
| docker info | æ˜¾ç¤º Docker ç³»ç»Ÿçš„è¯¦ç»†ä¿¡æ¯ã€‚ | docker info |
| docker stats | æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨çš„å®æ—¶èµ„æºä½¿ç”¨æƒ…å†µï¼ˆCPUã€å†…å­˜ç­‰ï¼‰ã€‚ | docker stats |
| docker inspect | æŸ¥çœ‹å®¹å™¨æˆ–é•œåƒçš„è¯¦ç»†ä¿¡æ¯ï¼ˆJSON æ ¼å¼ï¼‰ã€‚ | docker inspect container_id |
| docker save | å°†ä¸€ä¸ªé•œåƒä¿å­˜ä¸º tar æ–‡ä»¶ã€‚ | docker save -o myimage.tar myimage |
| docker load | ä» tar æ–‡ä»¶ä¸­åŠ è½½é•œåƒã€‚ | docker load -i myimage.tar |
| docker tag | ä¸ºé•œåƒæ·»åŠ æ ‡ç­¾ï¼ˆtagï¼‰ã€‚ | docker tag myimage myimage:v1 |
| docker buildx build | ä½¿ç”¨ Buildx æ„å»ºå¤šæ¶æ„é•œåƒã€‚ | docker buildx build -t myimage . |
| docker buildx create | åˆ›å»ºä¸€ä¸ªæ–°çš„ Buildx æ„å»ºå®ä¾‹ã€‚ | docker buildx create --use |
| docker buildx ls | åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„ Buildx æ„å»ºå®ä¾‹ã€‚ | docker buildx ls |
| docker buildx use | è®¾ç½®å½“å‰çš„ Buildx æ„å»ºå®ä¾‹ã€‚ | docker buildx use mybuilder |
| docker buildx bake | ä½¿ç”¨ Bake æ–‡ä»¶æ‰¹é‡æ„å»ºé•œåƒã€‚ | docker buildx bake -f bake.hcl |
| docker buildx build --push | æ„å»ºé•œåƒå¹¶æ¨é€åˆ°é•œåƒä»“åº“ã€‚ | docker buildx build --push -t myimage . |
| docker buildx build --platform | æ„å»ºé•œåƒå¹¶ä¸ºå¤šä¸ªå¹³å°ç”Ÿæˆæ”¯æŒã€‚ | docker buildx build --platform linux/amd64,linux/arm64 -t myimage . |

#### **runå‘½ä»¤çš„å‚æ•°ï¼ˆéå¸¸é‡è¦ï¼‰**
| å‚æ•°/é…ç½® | åŠŸèƒ½è¯´æ˜ | é‡è¦æ€§ä¸å‚è€ƒä¾æ® |
|:---|:---|:---|
| --name=ros_jazzy_opencv411_cuda128_cudnn971_noble | æŒ‡å®šå®¹å™¨åç§°ï¼Œä¾¿äºåç»­ç®¡ç† | æ›¿ä»£éšæœºç”Ÿæˆçš„å®¹å™¨åã€‚ |
| --gpus all | å…è®¸å®¹å™¨è®¿é—®å®¿ä¸»æœºæ‰€æœ‰GPUèµ„æºï¼Œéœ€NVIDIAé©±åŠ¨æ”¯æŒ | ç”¨äºCUDAåŠ é€Ÿç­‰GPUä¾èµ–ä»»åŠ¡ã€‚ |
| -e NVIDIA_DRIVER_CAPABILITIES=all | å¯ç”¨NVIDIAé©±åŠ¨çš„å…¨éƒ¨åŠŸèƒ½ï¼ˆå¦‚CUDAã€å›¾å½¢æ¸²æŸ“ï¼‰ | ç¡®ä¿å®¹å™¨å†…GPUåŠŸèƒ½å®Œæ•´67ã€‚ |
| -dit | ç»„åˆå‚æ•°ï¼š- -dï¼šåå°è¿è¡Œå®¹å™¨ï¼ˆDetachedæ¨¡å¼ï¼‰- -iï¼šä¿æŒæ ‡å‡†è¾“å…¥ï¼ˆSTDINï¼‰å¼€æ”¾- -tï¼šåˆ†é…ä¼ªç»ˆç«¯ï¼ˆTTYï¼‰ | å…è®¸å®¹å™¨åœ¨åå°è¿è¡Œå¹¶æ”¯æŒäº¤äº’æ“ä½œã€‚ |
| --privileged | èµ‹äºˆå®¹å™¨å®Œå…¨ä¸»æœºæƒé™ï¼ˆå¯è®¿é—®è®¾å¤‡ã€å†…æ ¸æ¨¡å—ç­‰ï¼‰ | ç”¨äºéœ€è¦ç›´æ¥æ“ä½œç¡¬ä»¶çš„åœºæ™¯ï¼ˆå¦‚è®¿é—®USBè®¾å¤‡ï¼‰ï¼Œä½†å­˜åœ¨å®‰å…¨é£é™©ã€‚ |
| --net=host | å…±äº«å®¿ä¸»æœºç½‘ç»œå‘½åç©ºé—´ï¼ˆå®¹å™¨ä½¿ç”¨å®¿ä¸»æœºIPå’Œç«¯å£ï¼‰ | ç®€åŒ–ç½‘ç»œé…ç½®ï¼Œæ— NATï¼Œè¿™æ ·çš„è¯ï¼Œç½‘ç»œæ•ˆç‡æ›´é«˜ï¼Œå±€åŸŸç½‘è®¾å¤‡æ›´å®¹æ˜“å‘ç°ã€‚ |
| --group-add audio--group-add video--group-add dialout | å°†å®¹å™¨ç”¨æˆ·åŠ å…¥å®¿ä¸»æœºç”¨æˆ·ç»„ï¼š- audioï¼šéŸ³é¢‘è®¾å¤‡è®¿é—®- videoï¼šè§†é¢‘è®¾å¤‡è®¿é—®- dialoutï¼šä¸²å£è®¾å¤‡è®¿é—® | é¿å…æƒé™é—®é¢˜ï¼ˆå¦‚é¿å…æ— æ³•è°ƒç”¨æ‘„åƒå¤´ã€éº¦å…‹é£ï¼‰ã€‚ |
| -e DISPLAY=$DISPLAY-e XAUTHORITY=/home/tungchiahui/.Xauthority-e WAYLAND_DISPLAY-e XDG_RUNTIME_DIR-e QT_QPA_PLATFORM=xcb | é…ç½®å›¾å½¢æ˜¾ç¤ºç¯å¢ƒï¼š- ç»‘å®šå®¿ä¸»æœºæ˜¾ç¤ºæ¥å£ï¼ˆX11æˆ–Waylandï¼‰- è®¾ç½®GUIåº”ç”¨æ¸²æŸ“åç«¯ | æ”¯æŒå®¹å™¨å†…è¿è¡Œå›¾å½¢ç•Œé¢åº”ç”¨ï¼ˆå¦‚OpenCVå¯è§†åŒ–ï¼‰ã€‚ |
| -v /tmp/.X11-unix:/tmp/.X11-unix:rw-v /dev/dri:/dev/dri | æŒ‚è½½å®¿ä¸»æœºå›¾å½¢è®¾å¤‡ï¼š- X11å¥—æ¥å­—ç›®å½•- ç›´æ¥æ¸²æŸ“ç®¡ç†å™¨ï¼ˆDRIï¼‰è®¾å¤‡ | å®ç°å®¹å™¨å†…å›¾å½¢æ˜¾ç¤ºã€‚ |
| -v $HOME/.Xauthority:/home/tungchiahui/.Xauthority:ro | æŒ‚è½½X11è®¤è¯æ–‡ä»¶ï¼ˆåªè¯»ï¼‰ | ç¡®ä¿å®¹å™¨æœ‰æƒè¿æ¥å®¿ä¸»æœºæ˜¾ç¤ºæœåŠ¡ã€‚ |
| -v /run/user/1000/wayland-0-v /run/user/1000 | æŒ‚è½½Waylandæ˜¾ç¤ºåè®®ç›¸å…³ç›®å½• | æ”¯æŒWaylandåè®®çš„å›¾å½¢æ˜¾ç¤ºã€‚ |
| --ulimit nofile=1024:524288 | è®¾ç½®è¿›ç¨‹**æœ€å¤§å¯æ‰“å¼€æ–‡ä»¶æ•°ï¼ˆnofileï¼‰**çš„æ–¹å¼ï¼Œç”¨äºæ§åˆ¶å®¹å™¨æˆ–è¿›ç¨‹è¿è¡Œæ—¶çš„æ–‡ä»¶å¥æŸ„æ•°é‡é™åˆ¶ã€‚--ulimit <é™åˆ¶ç±»å‹>=<è½¯é™åˆ¶>:<ç¡¬é™åˆ¶> | å¦‚æœé»˜è®¤é™åˆ¶å¤ªå°ï¼Œå¯èƒ½ä¼šå‡ºç° "too many open files" çš„é”™è¯¯ã€‚æ‰€ä»¥åœ¨å®¹å™¨è¿è¡Œæˆ–ç³»ç»ŸæœåŠ¡å¯åŠ¨æ—¶ï¼Œéœ€è¦è°ƒå¤§è¿™ä¸ªå€¼ã€‚--ulimit nofile=4096:65536 |
| -v /home/tungchiahui:/home/tungchiahui | æŒ‚è½½å®¿ä¸»æœºç”¨æˆ·ç›®å½•åˆ°å®¹å™¨å†…åŒåè·¯å¾„ | å®ç°å®¿ä¸»æœºä¸å®¹å™¨é—´æ–‡ä»¶å…±äº«ï¼ˆå¦‚ä»£ç ã€æ•°æ®æŒä¹…åŒ–ï¼‰ã€‚ |
| -w /home/tungchiahui | è®¾ç½®å®¹å™¨å¯åŠ¨åçš„é»˜è®¤å·¥ä½œç›®å½• | ç›´æ¥è¿›å…¥é¡¹ç›®è·¯å¾„ï¼Œæ–¹ä¾¿æ‰§è¡Œå‘½ä»¤2324ã€‚ |
| tungchiahui/ros-opencv:jazzy-411-cuda128-cudnn971-noble | é•œåƒåç§°æŒ‡å®šé•œåƒåŠæ ‡ç­¾ï¼ŒåŒ…å«ï¼š- ROS 2 Jazzy- OpenCV 4.11- CUDA 12.8- cuDNN 9.7.1 | æä¾›é¢„é…ç½®çš„æ·±åº¦å­¦ä¹ ä¸æœºå™¨äººå¼€å‘ç¯å¢ƒã€‚ |

ä¸‹æ–¹è¿™æ¡å‘½ä»¤ä¸€å®šè¦åœ¨æ™®é€šç”¨æˆ·ä¸‹è¿è¡Œï¼Œä¸è¦åœ¨rootç”¨æˆ·ä¸‹è¿è¡Œï¼Œå…¶å®åŠ ä¸åŠ `sudo`åŠ ä¸åŠ `sudo -E`éƒ½æ— æ‰€è°“ã€‚

ç”¨æˆ·å·²ç»è¢«åŠ åˆ°dockerç»„äº†ï¼Œä¸ç”¨`sudo`ä¹Ÿè¡Œè·‘ï¼Œå…¶æ¬¡ï¼Œ`sudo`è¿è¡Œçš„è¯ï¼Œä½ çš„`$HOME`å˜é‡ä¹Ÿä¸ä¼šå˜ï¼Œæ›´ä½•å†µåŠ ä¸Š-Eçš„è¯ï¼Œè¿™æ ·ä½ çš„`$HOME`æ›´ä¸å¯èƒ½å˜äº†ã€‚

```bash
sudo docker run --name=ros_opencv_cuda \
--gpus all \
-e NVIDIA_DRIVER_CAPABILITIES=all \
-e DISPLAY=$DISPLAY \
-dit \
--privileged \
--net=host \
--group-add audio \
--group-add video \
--group-add dialout \
-e XAUTHORITY=$HOME/.Xauthority \
-e WAYLAND_DISPLAY=$WAYLAND_DISPLAY \
-e XDG_RUNTIME_DIR=$XDG_RUNTIME_DIR \
-e QT_QPA_PLATFORM=xcb \
-v /tmp/.X11-unix:/tmp/.X11-unix:rw \
-v /dev/dri:/dev/dri \
-v $HOME/.Xauthority:$HOME/.Xauthority:ro \
-v /run/user/$(id -u)/wayland-0:/run/user/$(id -u)/wayland-0 \
-v /run/user/$(id -u):/run/user/$(id -u) \
-v $HOME:$HOME \
-w $HOME \
tungchiahui/ros-opencv:humble-411-cuda128-cudnn970-jammy
```

æ³¨æ„ï¼š

1.  `NVIDIA_DRIVER_CAPABILITIES=all` `--gpus all`æ²¡æœ‰è‹±ä¼Ÿè¾¾æ˜¾å¡è¯·æ³¨é‡Šã€‚

2.  \--nameåé¢è¯·è‡ªå·±ä¸ºå®¹å™¨èµ·åã€‚

3.  æœ€åä¸€è¡Œä»“åº“åç§°è¯·ä½ è‡ªå·±æ‰¾å¯¹åº”çš„é•œåƒå¡«ä¸Šã€‚

4.  ROS1åœ¨Fedoraå‘è¡Œç‰ˆä¸‹ä¼šçˆ†å†…å­˜ï¼Œéœ€è¦æ·»åŠ ä¸Šä¸‹é¢è¿™ä¸ªå‚æ•°ï¼Œå¦‚æœä½ ä¸æ˜¯Fedoraå’ŒROS1,***è¯·ä¸è¦åŠ ***ã€‚

```bash
--ulimit nofile=1024:524288 \
```

5.  å¦‚æœæƒ³ç”¨å½“å‰ç”¨æˆ·ç™»é™†å®¹å™¨,å¯ä»¥åŠ ä¸Šä¸‹é¢è¿™å‡ æ¡,ä½†éå¸¸éå¸¸***ä¸å»ºè®®*****.**

```bash
--user $(id -u):$(id -g) \
-v /etc/passwd:/etc/passwd:ro \
-v /etc/group:/etc/group:ro \
```

## å„ç§Dockerå®¹å™¨éƒ¨ç½²
### éƒ¨ç½²å®¹å™¨æ­¥éª¤
å…ˆä»dockerhubæ‹‰å–ï¼ˆdocker pullï¼‰é•œåƒï¼Œ**ç„¶åå†é€šè¿‡docker runå‘½ä»¤åˆ›å»ºå®¹å™¨å³å¯ã€‚**ï¼ˆç›´æ¥è¿è¡Œdocker runå‘½ä»¤ä¹Ÿè¡Œï¼Œè¿™ä¼šè‡ªå·±å¯»æ‰¾æœ¬åœ°é•œåƒå¹¶åˆ›å»ºï¼Œå¦‚æœæœ¬åœ°æ²¡æœ‰åˆ™ä¼šè‡ªåŠ¨å»dockerhubä¸Šå¯»æ‰¾é•œåƒå¹¶æ‹‰å–åˆ›å»ºå®¹å™¨ä¸€æ¡é¾™æœåŠ¡ã€‚ï¼‰

ä¸‹é¢æ˜¯å„å¤§å®¹å™¨æ‹‰å–çš„å‘½ä»¤ï¼ˆå‡æ”¯æŒamd64å’Œarm64æ¶æ„ï¼‰ï¼š

### å„å¤§å®¹å™¨æ‹‰å–
#### Vinciæœºå™¨äººé˜Ÿæš‚æ—¶ä¸»ä½¿ç”¨çš„dockerç‰ˆæœ¬
**ï¼ˆè¯¥ç‰ˆæœ¬æš‚æœªæ„å»ºä¸Šä¼ åˆ°dockerhubï¼Œä½†æ˜¯tungchiahui/ros-opencv:humble-411-cuda128-cudnn970-jammyå·²ç»å®ç°äº†ä¸‹åˆ—è¯´çš„å…¨éƒ¨äº†ï¼‰**

https://hub.docker.com/repositories/sdutvincirobot

https://github.com/SDUTVINCI/docker

ä½¿ç”¨ä»¥ä¸‹å¸¦æœ‰CUDAå’ŒCuDNNçš„Dockerå¿…é¡»æ»¡è¶³çš„æ¡ä»¶:

1.  æœ‰è‹±ä¼Ÿè¾¾NVIDIAç‹¬ç«‹æ˜¾å¡

2.  æ˜¾å¡é©±åŠ¨å¿…é¡»æ»¡è¶³â‰¥570.86.10

3.  è®¾å¤‡çš„æ¶æ„å¿…é¡»ä¸ºamd64(x86\_64)æ¶æ„æˆ–è€…aarch64(arm64)æ¶æ„ã€‚(ç»å¤§å¤šæ•°è®¾å¤‡å‡æ»¡è¶³)

4.  æ”¯æŒçš„æ˜¾å¡å‹å·å¦‚ä¸‹:

    1.  GTX10ç³»åˆ—æ¡Œé¢ç«¯ã€ç§»åŠ¨ç«¯æ˜¾å¡å‡å·²æ”¯æŒ

    2.  RTX20-RTX50ç³»åˆ—æ¡Œé¢ç«¯ã€ç§»åŠ¨ç«¯æ˜¾å¡å‡å·²æ”¯æŒ

    3.  NVIDIA Jetson AGX Orinã€NVIDIA Jetson Orin NXã€NVIDIA Jetson Orin Nanoå·¥æ§æœºå·²æ”¯æŒ

    4.  NVIDIA Jetson AGX Xavierã€NVIDIA Jetson Xavier NXå·¥æ§æœºå·²æ”¯æŒ

    5.  å…¶ä»–æ˜¾å¡å‡æœªé€‚é…ï¼Œå¼ºè¡Œä½¿ç”¨å…¶ä»–æ˜¾å¡è‚¯å®šä¼šæœ‰ä¸å…¼å®¹çš„é—®é¢˜ï¼Œå¦‚æœæƒ³è¦é€‚é…ä½ çš„æ˜¾å¡å‹å·ï¼Œè¯·å•ç‹¬è”ç³»å­¦é•¿

è¯¥é•œåƒåŒ…å«çš„å†…å®¹ï¼š

1.  Ubuntu22.04

2.  ROS2 Humble

3.  OpenCV4.11

4.  CUDA12.8

5.  CuDNN9.7.0

6.  cv\_bridge(amd64æ”¯æŒï¼Œä½†arm64æš‚æ—¶æ²¡æ„å»ºï¼Œè¯·è‡ªè¡Œæ„å»º)

7.  Livox-SDK2

8.  (ä½†æ— Livox-ROS-Driver2ï¼Œè‡ªå·±åœ¨wsä¸‹ç¼–è¯‘å§)

è¯·ç”µæ§ç»„æˆå‘˜åœ¨ç»„é•¿çš„å…è®¸ä¸‹ï¼Œå˜æ›´è¯¥dockeré•œåƒå†…å®¹ï¼Œdockerfileå’Œé•œåƒå‡ä¸Šä¼ åˆ°githubåŠdockerhubä¸Šäº†ã€‚

1.  ä»dockerhubä¸Šæ‹‰å–é•œåƒ

```bash
docker pull sdutvincirobot/ros-opencv:humble-411
```

#### ROS+OpenCVçº¯CPUç‰ˆæœ¬
https://hub.docker.com/repository/docker/tungchiahui/ros

https://github.com/tungchiahui/ros-docker/blob/main/README-zh\_CN.md

1.  ä»dockerhubä¸Šæ‹‰å–é•œåƒ

æš‚æ—¶ä¸»è¦ç»´æŠ¤ROS Humbleçš„ç‰ˆæœ¬ï¼Œå…¶ä»–ç‰ˆæœ¬éšç¼˜æ›´æ–°ï¼Œä½†ä¹ŸåŸºæœ¬éƒ½æ˜¯éå¸¸å¤Ÿç”¨çš„çŠ¶æ€ï¼ˆéšç€æˆ˜é˜Ÿä¸»è¦ä½¿ç”¨çš„ç‰ˆæœ¬è€Œå˜åŒ–ï¼‰

```bash
docker pull tungchiahui/ros:noetic-focal

docker pull tungchiahui/ros:humble-jammy

docker pull tungchiahui/ros:jazzy-noble
```

#### ï¼ˆæ— ROSï¼‰OpenCV4.11+CUDA12.8+CuDNN9.7.0
https://hub.docker.com/repository/docker/tungchiahui/opencv

https://github.com/tungchiahui/ros-docker/blob/main/README-zh\_CN.md

OpenCV4.11+CUDA12.8+CuDNN9.7.0ï¼š

ï¼ˆå› ä¸º50ç³»æ˜¾å¡æœ€ä½è¦è·‘CUDA12.8,æ‰€ä»¥æ‹‰é«˜é—¨æ§›ï¼‰

[https://pcnveplwrxf8.feishu.cn/sync/HtRPdZxPHsfwnwbXDsjcBfVcnah](https://pcnveplwrxf8.feishu.cn/sync/HtRPdZxPHsfwnwbXDsjcBfVcnah)

æš‚æ—¶ä¸»è¦ç»´æŠ¤Ubuntu Jammyçš„ç‰ˆæœ¬ï¼Œå…¶ä»–ç‰ˆæœ¬éšç¼˜æ›´æ–°ï¼Œä½†ä¹ŸåŸºæœ¬éƒ½æ˜¯éå¸¸å¤Ÿç”¨çš„çŠ¶æ€ï¼ˆéšç€æˆ˜é˜Ÿä¸»è¦ä½¿ç”¨çš„ç‰ˆæœ¬è€Œå˜åŒ–ï¼‰

```bash
docker pull tungchiahui/opencv:411-cuda128-cudnn970-focal

docker pull tungchiahui/opencv:411-cuda128-cudnn971-jammy

docker pull tungchiahui/opencv:411-cuda128-cudnn971-noble
```

#### ROS+OpenCV4.11+CUDA12.8+CuDNN9.7.0
https://hub.docker.com/repository/docker/tungchiahui/ros-opencv/general

https://github.com/tungchiahui/ros-docker/blob/main/README-zh\_CN.md

1.  æ‹‰å–é•œåƒï¼š

    Â Â ROS+OpenCV4.11+CUDA12.8+CuDNN9.7.0ï¼š

    Â Â ï¼ˆå› ä¸º50ç³»æ˜¾å¡æœ€ä½è¦è·‘CUDA12.8,æ‰€ä»¥æ‹‰é«˜é—¨æ§›ï¼‰

    ä½¿ç”¨ä»¥ä¸‹å¸¦æœ‰CUDAå’ŒCuDNNçš„Dockerå¿…é¡»æ»¡è¶³çš„æ¡ä»¶:

    1.  æœ‰è‹±ä¼Ÿè¾¾NVIDIAç‹¬ç«‹æ˜¾å¡

    2.  æ˜¾å¡é©±åŠ¨å¿…é¡»æ»¡è¶³â‰¥570.86.10

    3.  è®¾å¤‡çš„æ¶æ„å¿…é¡»ä¸ºamd64(x86\_64)æ¶æ„æˆ–è€…aarch64(arm64)æ¶æ„ã€‚(ç»å¤§å¤šæ•°è®¾å¤‡å‡æ»¡è¶³)

    4.  cv\_bridge(amd64æ”¯æŒï¼Œä½†arm64æš‚æ—¶æ²¡æ„å»ºï¼Œè¯·è‡ªè¡Œæ„å»º)

    5.  æ”¯æŒçš„æ˜¾å¡å‹å·å¦‚ä¸‹:

        1.  GTX10ç³»åˆ—æ¡Œé¢ç«¯ã€ç§»åŠ¨ç«¯æ˜¾å¡å‡å·²æ”¯æŒ

        2.  RTX20-RTX50ç³»åˆ—æ¡Œé¢ç«¯ã€ç§»åŠ¨ç«¯æ˜¾å¡å‡å·²æ”¯æŒ

        3.  NVIDIA Jetson AGX Orinã€NVIDIA Jetson Orin NXã€NVIDIA Jetson Orin Nanoå·¥æ§æœºå·²æ”¯æŒ

        4.  NVIDIA Jetson AGX Xavierã€NVIDIA Jetson Xavier NXå·¥æ§æœºå·²æ”¯æŒ

        5.  å…¶ä»–æ˜¾å¡å‡æœªé€‚é…ï¼Œå¼ºè¡Œä½¿ç”¨å…¶ä»–æ˜¾å¡è‚¯å®šä¼šæœ‰ä¸å…¼å®¹çš„é—®é¢˜ï¼Œå¦‚æœæƒ³è¦é€‚é…ä½ çš„æ˜¾å¡å‹å·ï¼Œè¯·å•ç‹¬è”ç³»å­¦é•¿

    Â Â æš‚æ—¶ä¸»è¦ç»´æŠ¤ROS Humbleçš„ç‰ˆæœ¬ï¼Œå…¶ä»–ç‰ˆæœ¬éšç¼˜æ›´æ–°ï¼Œä½†ä¹ŸåŸºæœ¬éƒ½æ˜¯éå¸¸å¤Ÿç”¨çš„çŠ¶æ€éšç€æˆ˜é˜Ÿä¸»è¦ä½¿ç”¨çš„ç‰ˆæœ¬è€Œå˜åŒ–ï¼‰

```bash
docker pull tungchiahui/ros-opencv:noetic-411-cuda128-cudnn970-focal

docker pull tungchiahui/ros-opencv:humble-411-cuda128-cudnn970-jammy

docker pull tungchiahui/ros-opencv:jazzy-411-cuda128-cudnn971-noble
```

## æ‰‹åŠ¨åˆ›å»ºDockeré•œåƒ
**ï¼ˆå«Œéº»çƒ¦çš„è¯ï¼Œç›´æ¥å»çœ‹å„ç§dockerå®¹å™¨éƒ¨ç½²çš„ç« èŠ‚ï¼‰ï¼ˆæœ‰åˆ«äººç»™ä½ åˆ›å»ºå¥½çš„ï¼Œå°±åˆ«è‡ªå·±æŠ˜è…¾å•¦ï¼‰**

### DockerFile
| æŒ‡ä»¤ | è¯´æ˜ | ç¤ºä¾‹ |
|:---|:---|:---|
| FROM | æŒ‡å®šåŸºç¡€é•œåƒï¼Œæ˜¯ Dockerfile çš„èµ·ç‚¹ | FROM ubuntu:22.04 |
| LABEL | æ·»åŠ å…ƒæ•°æ®ï¼ˆå¦‚ä½œè€…ã€ç‰ˆæœ¬ç­‰ï¼‰ | LABEL maintainer="you@example.com" |
| ENV | è®¾ç½®ç¯å¢ƒå˜é‡ | ENV PORT=8080 |
| ARG | æ„å»ºå‚æ•°ï¼Œåªåœ¨æ„å»ºæœŸé—´å¯ç”¨ | ARG VERSION=1.0 |
| RUN | æ„å»ºé•œåƒæ—¶è¿è¡Œå‘½ä»¤ | RUN apt-get update && apt-get install -y curl |
| COPY | å¤åˆ¶æ–‡ä»¶åˆ°é•œåƒä¸­ | COPY . /app |
| ADD | ç±»ä¼¼ COPYï¼Œé¢å¤–æ”¯æŒè§£å‹ .tar æ–‡ä»¶æˆ–è¿œç¨‹ URLï¼ˆä¸æ¨èç”¨äº URLï¼‰ | ADD archive.tar.gz /data/ |
| WORKDIR | è®¾ç½®å·¥ä½œç›®å½• | WORKDIR /opt |
| CMD | è®¾ç½®å®¹å™¨å¯åŠ¨æ—¶é»˜è®¤å‘½ä»¤ï¼ˆå¯è¢« docker run è¦†ç›–ï¼‰ | CMD ["node", "index.js"] |
| ENTRYPOINT | è®¾ç½®å®¹å™¨å¯åŠ¨æ—¶å›ºå®šå‘½ä»¤ï¼ˆé€šå¸¸ç”¨äº CLI å·¥å…·ç­‰ï¼‰ | ENTRYPOINT ["python3"] |
| EXPOSE | å£°æ˜é•œåƒå†…æœåŠ¡ç›‘å¬çš„ç«¯å£ï¼ˆä¸ä¼šè‡ªåŠ¨æ˜ å°„ï¼‰ | EXPOSE 80 |
| VOLUME | å£°æ˜æ•°æ®å·æŒ‚è½½ç‚¹ | VOLUME ["/data"] |
| USER | è®¾ç½®åç»­å‘½ä»¤æ‰§è¡Œçš„ç”¨æˆ· | USER appuser |
| ONBUILD | å½“é•œåƒä½œä¸ºå…¶ä»–é•œåƒåŸºç¡€é•œåƒæ—¶è§¦å‘çš„æ„å»ºæŒ‡ä»¤ | ONBUILD COPY . /src |
| SHELL | æ›´æ”¹é»˜è®¤ shellï¼Œæ¯”å¦‚å°† sh -c æ”¹ä¸º bash -c | SHELL ["/bin/bash", "-c"] |
| HEALTHCHECK | å®šä¹‰å®¹å™¨è¿è¡Œæ—¶çš„å¥åº·æ£€æŸ¥å‘½ä»¤ | `HEALTHCHECK CMD curl --fail http://localhost:8080 |
| STOPSIGNAL | å®¹å™¨åœæ­¢æ—¶å‘é€çš„ä¿¡å· | STOPSIGNAL SIGKILL |

### è‡ªå·±åˆ›å»ºå®¹å™¨
#### æ‰‹åŠ¨åˆ›å»º
https://github.com/tungchiahui/ros-docker

```bash

# DockerFileå†…å®¹è¯·çœ‹Githubä»“åº“ä¸­çš„DockerFile
```

åœ¨x86ç”µè„‘ä¸Šç¼–è¯‘x86çš„ï¼š

```bash
docker build -t ros-melodic-cuda118-cudnn8-bionic:latest .

docker build -t ros-noetic-focal:latest .

docker build -t ros-humble-jammy:latest .

docker build -t ros-jazzy-noble:latest .

docker build -t ros-humble-opencv411-cuda128-cudnn970-jammy:latest .

docker build -t ros-jazzy-opencv411-cuda128-cudnn970-noble:latest .
```

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image14.webp)

é•œåƒå¤§å°5GB(å‹ç¼©åçš„å¤§å°è¯¦è§DockerHub)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image15.webp)

å°† Docker é•œåƒæ¨é€åˆ° Docker Hub çš„æ­¥éª¤å¦‚ä¸‹ï¼š

1.  åˆ›å»º Docker Hub è´¦æˆ·

å¦‚æœä½ è¿˜æ²¡æœ‰ Docker Hub è´¦æˆ·ï¼Œè¯·å‰å¾€ Docker Hub æ³¨å†Œä¸€ä¸ªå…è´¹è´¦æˆ·ã€‚

2.  ç™»å½• Docker Hub

åœ¨ç»ˆç«¯ä¸­ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç™»å½•åˆ°ä½ çš„ Docker Hub è´¦æˆ·ï¼š

```bash
docker login
```

è¾“å…¥ä½ çš„ Docker Hub ç”¨æˆ·åå’Œå¯†ç è¿›è¡ŒéªŒè¯ã€‚

3.  ä¸ºä½ çš„é•œåƒæ‰“æ ‡ç­¾

Docker Hub ä½¿ç”¨ `<ç”¨æˆ·å>/<é•œåƒå>:<æ ‡ç­¾>` çš„æ ¼å¼æ¥æ ‡è¯†é•œåƒã€‚ä½ éœ€è¦ä¸ºä½ çš„é•œåƒæ‰“ä¸Šæ ‡ç­¾ï¼Œä»¥ä¾¿èƒ½å¤Ÿæ¨é€åˆ° Docker Hubã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
docker tag ros-jazzy-noble:latest <ä½ çš„ç”¨æˆ·å>/ros-jazzy-noble:latest
```

ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„ Docker Hub ç”¨æˆ·åæ˜¯ `tungchiahui`ï¼Œä½ åº”è¯¥æ‰§è¡Œï¼š

```bash
docker tag ros-noetic-focal:latest tungchiahui/ros-noetic-focal:latest

docker tag ros-humble-jammy:latest tungchiahui/ros-humble-jammy:latest

docker tag ros-jazzy-noble:latest tungchiahui/ros-jazzy-noble:latest

docker tag ros-humble-opencv411-cuda128-cudnn970-jammy:latest tungchiahui/ros-humble-opencv411-cuda128-cudnn970-jammy:latest

docker tag ros-jazzy-opencv411-cuda128-cudnn970-noble:latest tungchiahui/ros-jazzy-opencv411-cuda128-cudnn970-noble:latest
```

4.  æ¨é€é•œåƒåˆ° Docker Hub

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†é•œåƒæ¨é€åˆ° Docker Hubï¼š

```bash
docker push <ä½ çš„ç”¨æˆ·å>/ros-noetic-jazzy-noble:latest
```

ä¾‹å¦‚ï¼š

```bash
docker push tungchiahui/ros-noetic-focal:latest

docker push tungchiahui/ros-humble-jammy:latest

docker push tungchiahui/ros-jazzy-noble:latest

docker push tungchiahui/ros-humble-opencv411-cuda128-cudnn970-jammy:latest

docker push tungchiahui/ros-jazzy-opencv411-cuda128-cudnn970-noble:latest

docker push tungchiahui/ros-noetic-focal-arm64:latest
```

5.  éªŒè¯æ¨é€æˆåŠŸ

ä½ å¯ä»¥é€šè¿‡è®¿é—® Docker Hub çš„ä¸ªäººé¡µé¢æ¥éªŒè¯ä½ çš„é•œåƒæ˜¯å¦å·²æˆåŠŸæ¨é€ã€‚

**æ³¨æ„äº‹é¡¹**

*   ç¡®ä¿ä½ çš„é•œåƒå¤§å°åœ¨ Docker Hub çš„é™åˆ¶èŒƒå›´å†…ï¼ˆä¸€èˆ¬ä¸º 10GBï¼‰ã€‚

*   å¦‚æœä½ æ‰“ç®—å°†é•œåƒå…¬å¼€ï¼Œå¯ä»¥è®¾ç½®ä¸ºå…¬å…±ä»“åº“ï¼›å¦‚æœå¸Œæœ›åªæœ‰ä½ è‡ªå·±å¯ä»¥è®¿é—®ï¼Œå¯ä»¥è®¾ç½®ä¸ºç§æœ‰ä»“åº“ã€‚

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image16.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image17.webp)

#### æ‰‹åŠ¨åˆ›å»º(è·¨å¹³å°å¤šæ¶æ„æ„å»º)
å¦‚æœæ‚¨æƒ³åœ¨ **x86/x64 ç”µè„‘ä¸Šå³ä¸ºæœ¬æœºx86è®¾å¤‡æ„å»ºé•œåƒï¼Œåˆæƒ³ä¸ºæ ‘è“æ´¾ã€Jetsonç­‰ARM64 è®¾å¤‡æ„å»º Docker é•œåƒ** ï¼Œéœ€è¦ä½¿ç”¨ **Docker çš„è·¨å¹³å°æ„å»ºåŠŸèƒ½** ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´è§£å†³æ–¹æ¡ˆï¼š

* * *

1\. **å¯ç”¨ Docker è·¨å¹³å°æ„å»º**

åœ¨ x86 ä¸»æœºä¸Šæ¨¡æ‹Ÿ ARM64 ç¯å¢ƒéœ€è¦ä»¥ä¸‹å·¥å…·ï¼š

ç¬¬ä¸€æ­¥ï¼šå¯ç”¨ buildxï¼ˆåªéœ€æ‰§è¡Œä¸€æ¬¡ï¼‰

```Shell
docker buildx create --name multiarch_builder --use
```

è¿™ä¼šåˆ›å»ºå¹¶å¯ç”¨ä¸€ä¸ªæ”¯æŒå¤šæ¶æ„æ„å»ºçš„ builderï¼Œç”µè„‘é‡å¯åä¹Ÿä¾ç„¶å­˜åœ¨ï¼Œæ‰€ä»¥åªç”¨è¿è¡Œä¸€æ¬¡ã€‚

ç¬¬äºŒæ­¥ï¼šå®‰è£… QEMU æ”¯æŒï¼ˆä¸€èˆ¬æ–°ç‰ˆ Docker Desktop å·²è‡ªå¸¦ï¼Œä½†æ˜¯Linuxå¿…é¡»è¦å®‰è£…ï¼‰ å¦‚æœä½ ç”¨çš„æ˜¯æœåŠ¡å™¨æˆ–Linuxå‘è¡Œç‰ˆï¼Œç¡®ä¿æœ‰ qemu æ¨¡æ‹Ÿå™¨ï¼š

```bash
docker run --rm --privileged multiarch/qemu-user-static --reset -p yes
```

ç”µè„‘é‡å¯åï¼Œå°±ä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥éœ€è¦ä½ æ¯æ¬¡ç”µè„‘é‡å¯åï¼Œåœ¨buildxå‘½ä»¤å‰ï¼Œè¿è¡Œä¸€æ¬¡è¯¥å‘½ä»¤å³å¯ã€‚

ç¬¬ä¸‰æ­¥ï¼šæ„å»ºå¤šæ¶æ„é•œåƒ ç”¨ä¸‹é¢çš„å‘½ä»¤æ„å»º amd64 å’Œ arm64ï¼š

```bash
docker buildx build --platform linux/amd64,linux/arm64 -t <ä½ çš„é•œåƒå>:<æ ‡ç­¾> --push .

# ä¾‹å­ï¼š
docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/ros:noetic-focal \
 --push \
 .

docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/ros:humble-jammy \
 --push \
 .

docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/ros:jazzy-noble \
 --push \
 .

 docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/opencv:411-cuda128-cudnn970-focal \
 --push \
 .

docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/opencv:411-cuda128-cudnn971-jammy \
 --push \
 .

 docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/opencv:411-cuda128-cudnn971-noble \
 --push \
 .

docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/ros-opencv:noetic-411-cuda128-cudnn970-focal \
 --push \
 .

docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/ros-opencv:humble-411-cuda128-cudnn970-jammy \
 --push \
 .

 docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t tungchiahui/ros-opencv:jazzy-411-cuda128-cudnn970-noble \
 --push \
 .

  docker buildx build \
--platform linux/amd64,linux/arm64 \
 -t sdutvincirobot/ros-opencv:humble-411-cuda128-cudnn970-jammy \
 --push \
 .
```

è¯´æ˜ï¼š --platform æŒ‡å®šå¤šæ¶æ„ã€‚ --push æ˜¯å¿…é¡»çš„ï¼Œå› ä¸º buildx çš„å¤šå¹³å°æ„å»ºé»˜è®¤æ˜¯ä¸èƒ½æœ¬åœ°åŠ è½½çš„ï¼ˆé™¤éåŠ  --loadï¼Œä½†é‚£åªèƒ½æ”¯æŒå•ä¸€æ¶æ„ï¼‰ã€‚

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image18.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image19.webp)

#### æ¸…é™¤æ„å»ºç¼“å­˜
```C++

# æ¸…ç†BuildKitæ„å»ºç¼“å­˜
docker builder prune -f  
```

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image20.webp)

## VScodeè¿œç¨‹å¼€å‘
1.  æ’ä»¶1ï¼šå¾®è½¯Dockerå·¥å…·

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image21.webp)

*dockeræ‰©å±•æ’ä»¶å·²ç»è¿›åŒ–ä¸ºcontainer toolsäº†ï¼Œè¯·å®‰è£…container toolsã€‚*

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image22.webp)

2.  æ’ä»¶2ï¼šå¾®è½¯Dockerè¿œç¨‹å¼€å‘å·¥å…·

ä¸‹é¢è¿™æ˜¯è¿œç¨‹å¼€å‘çš„æ’ä»¶ã€‚

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image23.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image24.webp)

ä¸Šè¿°æ•™ç¨‹å·²ç»æŒ‚è½½äº†æœ¬åœ°ç£ç›˜äº†ï¼Œæ‰€ä»¥åœ¨Dockerå®¹å™¨ä¸­å¯ä»¥è½»æ¾è®¿é—®æœ¬åœ°çš„å·¥ç¨‹ã€‚

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2024/10/03/image25.webp)
