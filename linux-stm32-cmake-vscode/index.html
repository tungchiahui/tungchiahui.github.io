<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Linux-STM32-CMake-VScode环境搭建 | 小辉的折腾天地</title>

  <!-- 引入 CSS 样式 -->
  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="stylesheet" href="/assets/css/header.css">
  <link rel="stylesheet" href="/assets/css/footer.css">
  <link rel="stylesheet" href="/assets/css/post.css">
  <link rel="stylesheet" href="/assets/css/friends.css">
  <link rel="stylesheet" href="/assets/css/blog.css">
  <link rel="stylesheet" href="/assets/css/index.css">

  <!-- 代码高亮样式 -->
  <link rel="stylesheet" href="/assets/css/code-highlight.css">

  <!-- 国内Font Awesome镜像 -->
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/7.0.0/css/all.min.css">

  <!-- === 图片点击放大功能 === -->
  <script src="https://cdn.bootcdn.net/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js"></script>

  <!-- 网站图标 -->
  
  <link rel="icon" 
        href="https://cdn.tungchiahui.cn/tungwebsite/assets/images/favicon.webp">

  <!-- Vercount 网站访问统计 -->
  <script defer src="https://events.vercount.one/js"></script>

</head>

  <body>
    <header class="site-header">

  <!-- 内容层 -->
  <div class="header-content">
    <h1><a href="/">小辉的折腾天地</a></h1>
    <nav>
      <ul>
        <li><a href="/">首页</a></li>
        <li><a href="/blog/">博客</a></li>
        <li><a href="/cv/">简历</a></li>
        <li><a href="/friends/">友链</a></li>
        <li><a href="/about/">关于</a></li>
      </ul>
    </nav>
  </div>
</header>

    <main>
      <article class="post-main">
  <h2>Linux-STM32-CMake-VScode环境搭建</h2>
  <p>
    <small>
      发布于 2025-07-18 | 作者: Tung Chia-hui | 阅读次数：<span id="vercount_value_page_pv">Loading</span> 次
    </small>
  </p>
  <div class="post-content">
    <ul id="markdown-toc">
  <li><a href="#简介" id="markdown-toc-简介">简介</a></li>
  <li><a href="#linux" id="markdown-toc-linux">Linux</a>    <ul>
      <li><a href="#环境介绍" id="markdown-toc-环境介绍">环境介绍</a></li>
      <li><a href="#安装各种环境" id="markdown-toc-安装各种环境">安装各种环境</a>        <ul>
          <li><a href="#安装cc环境" id="markdown-toc-安装cc环境">安装C/C++环境</a></li>
          <li><a href="#安装cubemx" id="markdown-toc-安装cubemx">安装CubeMX</a></li>
          <li><a href="#安装vscode" id="markdown-toc-安装vscode">安装VScode</a></li>
          <li><a href="#安装arm-gnu工具链" id="markdown-toc-安装arm-gnu工具链">安装ARM GNU工具链</a>            <ul>
              <li><a href="#安装" id="markdown-toc-安装">安装</a>                <ul>
                  <li><a href="#方法一官网法" id="markdown-toc-方法一官网法">方法一（官网法）</a></li>
                  <li><a href="#方法二系统仓库法" id="markdown-toc-方法二系统仓库法">方法二（系统仓库法）</a></li>
                </ul>
              </li>
              <li><a href="#测试" id="markdown-toc-测试">测试</a></li>
            </ul>
          </li>
          <li><a href="#安装jlink驱动" id="markdown-toc-安装jlink驱动">安装JLink驱动</a>            <ul>
              <li><a href="#安装libreadline库" id="markdown-toc-安装libreadline库">安装libreadline库</a></li>
              <li><a href="#安装jlink驱动-1" id="markdown-toc-安装jlink驱动-1">安装JLink驱动</a></li>
              <li><a href="#下载并安装ozone" id="markdown-toc-下载并安装ozone">下载并安装Ozone</a></li>
              <li><a href="#测试-1" id="markdown-toc-测试-1">测试</a></li>
            </ul>
          </li>
          <li><a href="#下载svd" id="markdown-toc-下载svd">下载SVD</a></li>
        </ul>
      </li>
      <li><a href="#工程创建与测试" id="markdown-toc-工程创建与测试">工程创建与测试</a>        <ul>
          <li><a href="#使用cubemx创建工程" id="markdown-toc-使用cubemx创建工程">使用CubeMX创建工程</a></li>
          <li><a href="#对工程进行配置与编译" id="markdown-toc-对工程进行配置与编译">对工程进行配置与编译</a></li>
          <li><a href="#对代码提示进行配置" id="markdown-toc-对代码提示进行配置">对代码提示进行配置</a></li>
          <li><a href="#移植vinci机器人队标准cc工程模板" id="markdown-toc-移植vinci机器人队标准cc工程模板">移植Vinci机器人队标准C/C++工程模板</a></li>
          <li><a href="#下载程序到板子" id="markdown-toc-下载程序到板子">下载程序到板子</a>            <ul>
              <li><a href="#配置cmake生成bin和hex文件" id="markdown-toc-配置cmake生成bin和hex文件">配置CMake生成.bin和.hex文件</a></li>
              <li><a href="#将设备连接到jlink并烧录程序" id="markdown-toc-将设备连接到jlink并烧录程序">将设备连接到JLink并烧录程序</a>                <ul>
                  <li><a href="#图形界面烧录" id="markdown-toc-图形界面烧录">图形界面烧录</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li><a href="#使用ozone进行flash烧录和debug调试" id="markdown-toc-使用ozone进行flash烧录和debug调试">使用ozone进行Flash烧录和Debug调试</a>            <ul>
              <li><a href="#基础配置" id="markdown-toc-基础配置">基础配置</a></li>
              <li><a href="#烧录与调试" id="markdown-toc-烧录与调试">烧录与调试</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#windows" id="markdown-toc-windows">Windows</a>    <ul>
      <li><a href="#环境准备" id="markdown-toc-环境准备">环境准备</a></li>
    </ul>
  </li>
</ul>

<p><strong><em><code class="language-plaintext highlighter-rouge">（本教程为2025年7月创建的，可能与以后的版本有些出入）</code></em></strong></p>

<p>https://blog.csdn.net/SankeXhy/article/details/138418371?shareId=138418371&amp;sharefrom=link&amp;sharerefer=APP&amp;sharesource=2301_80523028&amp;sharetype=blog</p>

<h1 id="简介">简介</h1>

<ul>
  <li>
    <p>CubeMX + CMake +GCC + HAL + VSCode + Clangd + Ozone 构成了全链路嵌入式开发方案： CubeMX解决硬件配置问题，CMake统一构建流程，GCC提供编译支持，HAL库屏蔽硬件差异，VSCode+Clangd打造智能编辑器,Ozone实现更方便高效的debug调试功能。</p>
  </li>
  <li>
    <p>该组合降低开发门槛（尤其对跨平台项目），提升代码质量与可维护性，并适配从原型到量产的全生命周期需求，是STM32等ARM嵌入式开发的推荐实践。</p>
  </li>
</ul>

<h1 id="linux">Linux</h1>

<h2 id="环境介绍">环境介绍</h2>

<p>本教程环境介绍：</p>

<ol>
  <li>
    <p>系统：Fedora 42 KDE Edition Linux</p>
  </li>
  <li>
    <p>系统内核：Linux 6.15.6-200.fc42.x86_64</p>
  </li>
  <li>
    <p>架构：X86_64</p>
  </li>
</ol>

<p>其他Linux环境也可以。</p>

<h2 id="安装各种环境">安装各种环境</h2>

<h3 id="安装cc环境">安装C/C++环境</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>
<span class="c"># debian系</span>
<span class="nb">sudo </span>apt-get <span class="nb">install </span>gcc g++ gdb cmake-gui make

<span class="c"># rhel系</span>
<span class="nb">sudo </span>dnf <span class="nb">install </span>gcc g++ gdb cmake-gui make
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image1.webp" alt="" /></p>

<p>查看是否环境安装成功</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>gcc -v
g++ -v
gdb -v
cmake --version
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image2.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image3.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image4.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image5.webp" alt="" /></p>

<p>接下来测试是否能够对C/C++正常编译，请找一个存放C++代码的文件夹，然后在终端中cd进去。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image6.webp" alt="" /></p>

<p>然后创建一个.cpp文件并用vim编辑</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>vim hello.cpp
</pre></td></tr></tbody></table></code></pre></div></div>

<p>复制以下代码到该文件里</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="c1"> </span><span class="cp">
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span><span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> 
<span class="p">{</span> 
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"你好，机电创新学会！"</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> 
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span> 
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>然后编译</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>g++ <span class="nt">-o</span> hello hello.cpp
<span class="nb">ls</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image7.webp" alt="" /></p>

<p>运行</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>./hello
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image8.webp" alt="" /></p>

<p>说明环境已经配置好了</p>

<h3 id="安装cubemx">安装CubeMX</h3>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image9.webp" alt="" /></p>

<p>下载地址：</p>

<p>https://www.st.com.cn/zh/development-tools/stm32cubemx.html</p>

<p><strong>推荐下载6.14.1版本（不要下载6.15.0,这个版本有bug，不知道后续何时会修复）</strong></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image10.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image11.webp" alt="" /></p>

<p>解压出来</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image12.webp" alt="" /></p>

<p>用root权限打开这个软件<code class="language-plaintext highlighter-rouge">SetupSTM32CubeMX-6.15.0</code></p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">sudo</span> <span class="p">.</span><span class="o">/</span><span class="n">SetupSTM32CubeMX</span><span class="o">-</span><span class="mf">6.15.0</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image13.webp" alt="" /></p>

<p>在新弹出的界面一直点下一步就行，安装结束后出现如下图就成功了。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image14.webp" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">/usr/local/STMicroelectronics/STM32Cube/STM32CubeMX</code>进入这个文件夹，然后打开终端输入</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">.</span><span class="o">/</span><span class="n">STM32CubeMX</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image15.webp" alt="" /></p>

<p>点击Help</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image16.webp" alt="" /></p>

<p>选<code class="language-plaintext highlighter-rouge">Manage embedded software packages</code>，把STM32F1，F4，H7的第一个最新的固件勾上。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image17.webp" alt="" /></p>

<p>点install</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image18.webp" alt="" /></p>

<p>登陆上账号</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image19.webp" alt="" /></p>

<p>然后等下载和安装完</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image20.webp" alt="" /></p>

<p>下载好就行了。</p>

<p>接下来可以把CubeMX应用配置一个桌面快捷方式等可以快速打开，教程详见<a href="https://sdutvincirobot.feishu.cn/wiki/GIKnwJo39iREkHkFGvqcy5Osntc">Vinci机器人队Linux入门教程</a>的Appimage章节，可以用ctrl+F快速定位该章节。</p>

<p>桌面快捷方式如下：</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="n">Desktop</span> <span class="n">Entry</span><span class="p">]</span>
<span class="n">Name</span><span class="o">=</span><span class="n">STM32CubeMX</span>
<span class="n">Exec</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">STMicroelectronics</span><span class="o">/</span><span class="n">STM32Cube</span><span class="o">/</span><span class="n">STM32CubeMX</span><span class="o">/</span><span class="n">STM32CubeMX</span>
<span class="n">Icon</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">STMicroelectronics</span><span class="o">/</span><span class="n">STM32Cube</span><span class="o">/</span><span class="n">STM32CubeMX</span><span class="o">/</span><span class="n">help</span><span class="o">/</span><span class="n">STM32CubeMX</span><span class="p">.</span><span class="n">png</span>
<span class="n">Type</span><span class="o">=</span><span class="n">Application</span>
<span class="n">Categories</span><span class="o">=</span><span class="n">Development</span><span class="p">;</span><span class="n">Electronics</span><span class="p">;</span><span class="n">Embedded</span><span class="p">;</span>
<span class="n">Comment</span><span class="o">=</span><span class="n">STM32CubeMX</span> <span class="n">configuration</span> <span class="n">and</span> <span class="n">code</span> <span class="n">generation</span> <span class="n">tool</span>
<span class="n">Terminal</span><span class="o">=</span><span class="nb">false</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>根据教程做，就可以实现这种效果啦。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image21.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image22.webp" alt="" /></p>

<h3 id="安装vscode">安装VScode</h3>

<p>https://code.visualstudio.com/Download</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image23.webp" alt="" /></p>

<p>如果是debian系下载deb,如果是rhel系下载rpm.</p>

<p>下载完之后，点击浏览器，找到这个安装包的文件夹，并在该路径打开终端。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image24.webp" alt="" /></p>

<p>Debian系：输入<code class="language-plaintext highlighter-rouge">sudo apt install ./code</code>然后按<code class="language-plaintext highlighter-rouge">tab</code>按键补齐文件名，回车。</p>

<p>RHEL系：输入<code class="language-plaintext highlighter-rouge">sudo dnf install ./code</code>然后按<code class="language-plaintext highlighter-rouge">tab</code>按键补齐文件名，回车。</p>

<p>例如补齐后的：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>dnf <span class="nb">install</span> ./code-1.102.1-1752598767.el8.x86_64.rpm
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image25.webp" alt="" /></p>

<p>然后打开VScode，在终端输入下面的命令</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>code
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image26.webp" alt="" /></p>

<p>然后安装一些插件</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image27.webp" alt="" /></p>

<p>下面这些都要装</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image28.webp" alt="" /><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image29.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image30.webp" alt="" /><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image31.webp" alt="" /></p>

<h3 id="安装arm-gnu工具链">安装ARM GNU工具链</h3>

<p>编译工具比较：</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">特性</th>
      <th style="text-align: left">ARM GCC (GNU 工具链)</th>
      <th style="text-align: left">Keil AC5 (ARM Compiler 5)</th>
      <th style="text-align: left">Keil AC6 (ARM Compiler 6)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">核心身份</td>
      <td style="text-align: left">基于GNU GPL的开源编译器</td>
      <td style="text-align: left">ARM自家的传统编译器</td>
      <td style="text-align: left">基于LLVM/Clang的现代编译器</td>
    </tr>
    <tr>
      <td style="text-align: left">许可模式</td>
      <td style="text-align: left">免费、开源</td>
      <td style="text-align: left">商业收费（包含在MDK中）</td>
      <td style="text-align: left">商业收费（包含在MDK中）</td>
    </tr>
    <tr>
      <td style="text-align: left">代码生成/优化</td>
      <td style="text-align: left">良好，持续改进</td>
      <td style="text-align: left">优秀（尤其在小代码尺寸上）</td>
      <td style="text-align: left">极佳，在性能与尺寸间有最佳平衡</td>
    </tr>
    <tr>
      <td style="text-align: left">标准兼容性</td>
      <td style="text-align: left">紧跟最新C/C++标准（如C17，C++17/20）</td>
      <td style="text-align: left">主要支持C++98，较陈旧</td>
      <td style="text-align: left">支持现代C++（C++11/14/17），兼容性更好</td>
    </tr>
    <tr>
      <td style="text-align: left">错误/警告信息</td>
      <td style="text-align: left">比较清晰易懂</td>
      <td style="text-align: left">相对晦涩</td>
      <td style="text-align: left">非常清晰和友好，类似GCC/Clang</td>
    </tr>
    <tr>
      <td style="text-align: left">与Keil MDK集成</td>
      <td style="text-align: left">需要手动配置或通过CubeIDE</td>
      <td style="text-align: left">原生、无缝集成</td>
      <td style="text-align: left">原生、无缝集成，是ARM推荐选择</td>
    </tr>
    <tr>
      <td style="text-align: left">链接脚本</td>
      <td style="text-align: left">使用自有的链接脚本语法（.ld文件）</td>
      <td style="text-align: left">使用ARM自家的分散加载文件语法（.sct）</td>
      <td style="text-align: left">使用ARM自家的分散加载文件语法（.sct）</td>
    </tr>
    <tr>
      <td style="text-align: left">汇编语法</td>
      <td style="text-align: left">使用GNU汇编语法（.S文件）</td>
      <td style="text-align: left">使用ARM汇编语法（.s）</td>
      <td style="text-align: left">使用ARM汇编语法（.s），但AC6更严格</td>
    </tr>
    <tr>
      <td style="text-align: left">生态与未来</td>
      <td style="text-align: left">生态强大，是很多开源项目（如Zephyr，ESP-IDF）和IDE（CubeIDE，VS Code）的首选</td>
      <td style="text-align: left">处于维护模式，ARM不再增加新功能，不推荐新项目使用</td>
      <td style="text-align: left">是ARM的未来和主力，持续更新和优化</td>
    </tr>
  </tbody>
</table>

<hr />

<h4 id="安装">安装</h4>

<p><strong>建议都用</strong><strong>官方法</strong><strong>进行安装。</strong></p>

<h5 id="方法一官网法">方法一（官网法）</h5>

<p>https://developer.arm.com/downloads/-/arm-gnu-toolchain-downloads</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image32.webp" alt="" /></p>

<p>进入下载目录并打开终端</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image33.webp" alt="" /></p>

<p>在终端里输入下列命令，将编译器文件tar压缩包复制到你存放程序的文件夹（这个文件夹你自己定，建议在home分区，别以后删了就行）。</p>

<p>具体命令为<code class="language-plaintext highlighter-rouge">cp ./arm-gnu</code>然后按<code class="language-plaintext highlighter-rouge">tab</code>补齐，然后空格，再跟上你要复制到的文件夹的路径。</p>

<p>比如下面的命令：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cp</span> ./arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi.tar.xz ~/UserFolder/Applications/
</pre></td></tr></tbody></table></code></pre></div></div>

<p>然后进入复制到的文件夹：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> ~/UserFolder/Applications/
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image34.webp" alt="" /></p>

<p>在终端里输入<code class="language-plaintext highlighter-rouge">tar -xvf ./arm-gnu</code>并按<code class="language-plaintext highlighter-rouge">tab</code>补齐。</p>

<p>例如我补齐后的：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> <span class="nb">tar</span> <span class="nt">-xvf</span> ./arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi.tar.xz
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image35.webp" alt="" /></p>

<p>再进入这个解压后的文件夹</p>

<p><code class="language-plaintext highlighter-rouge">cd ./arm-gnu</code>按<code class="language-plaintext highlighter-rouge">tab</code>补齐。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> ./arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/
<span class="nb">cd</span> ./bin
</pre></td></tr></tbody></table></code></pre></div></div>

<p>查看文件夹路径</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">pwd</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image36.webp" alt="" /></p>

<p>复制一下<code class="language-plaintext highlighter-rouge">/home/tungchiahui/UserFolder/Applications/arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/bin</code></p>

<p>然后需要配置环境</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>vim ~/.bashrc
</pre></td></tr></tbody></table></code></pre></div></div>

<p>在末尾输入下面的命令，把下面<code class="language-plaintext highlighter-rouge">~/UserFolder/Applications/arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/bin</code>替换成你刚才复制的路径，<code class="language-plaintext highlighter-rouge">/home/用户名</code>可以用<code class="language-plaintext highlighter-rouge">~</code>来代替。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>/home/tungchiahui/UserFolder/Applications/arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/bin:<span class="nv">$PATH</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image37.webp" alt="" /></p>

<p>加载环境</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">source</span> ~/.bashrc
</pre></td></tr></tbody></table></code></pre></div></div>

<h5 id="方法二系统仓库法">方法二（系统仓库法）</h5>

<p><strong>不建议本法</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>
<span class="c"># Debian系</span>
<span class="nb">sudo </span>apt <span class="nb">install </span>arm-none-eabi-gcc

<span class="c"># Rhel系</span>
<span class="nb">sudo </span>dnf <span class="nb">install </span>arm-none-eabi-gcc
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image38.webp" alt="" /></p>

<h4 id="测试">测试</h4>

<p>检查版本</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>arm-none-eabi-gcc <span class="nt">-v</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image39.webp" alt="" /></p>

<h3 id="安装jlink驱动">安装JLink驱动</h3>

<h4 id="安装libreadline库">安装libreadline库</h4>

<p>我们烧录会用到JLinkExe的命令，而JLinkExe会用到libreadline库，所以要安装libreadline库，执行如下命令安装：</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>
<span class="c"># debian系</span>
<span class="nb">sudo </span>apt-get <span class="nb">install </span>libreadline-dev

<span class="c"># rhel系</span>
<span class="nb">sudo </span>dnf <span class="nb">install </span>readline-devel
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image40.webp" alt="" /></p>

<h4 id="安装jlink驱动-1">安装JLink驱动</h4>

<p>https://www.segger.com/downloads/jlink/</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image41.webp" alt="" /></p>

<p>是Debian系下载64位DEB</p>

<p>是RHEL系下载64位RPM</p>

<p>（这里的64位指的是amd64和X86_64,如果你是ARM64请下载下方那个Linux ARM里的64位）</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image42.webp" alt="" /></p>

<p>打开下载到的文件夹，并打开终端</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image43.webp" alt="" /></p>

<p>然后<code class="language-plaintext highlighter-rouge">sudo apt install ./JLink</code>然后tab补齐。</p>

<p>然后<code class="language-plaintext highlighter-rouge">sudo dnf install ./JLink</code>然后tab补齐。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>dnf <span class="nb">install</span> ./JLink_Linux_V852_x86_64.rpm
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image44.webp" alt="" /></p>

<p>检查是否安装成功</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>JLinkExe
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image45.webp" alt="" /></p>

<p>我们点击No，然后会进入Commander交互模式，在这种模式下，我们可以执行各种 J-Link Commander 提供的命令来连接、配置调试器，下载程序或文件到目标设备等操作，感兴趣的同学可自行学习。</p>

<p>执行“q”指令退出该模式。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image46.webp" alt="" /></p>

<h4 id="下载并安装ozone">下载并安装Ozone</h4>

<p>https://www.segger.com/products/development-tools/ozone-j-link-debugger/</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image47.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image48.webp" alt="" /></p>

<p>是Debian系下载64位DEB</p>

<p>是RHEL系下载64位RPM</p>

<p>（这里的64位指的是amd64和X86_64,如果你是ARM64请下载下方那个Linux ARM里的64位）</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image49.webp" alt="" /></p>

<p>然后<code class="language-plaintext highlighter-rouge">sudo apt install ./Ozone</code>然后tab补齐。</p>

<p>然后<code class="language-plaintext highlighter-rouge">sudo dnf install ./Ozone</code>然后tab补齐。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>dnf <span class="nb">install</span> ./Ozone_Linux_V338g_x86_64.rpm
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image50.webp" alt="" /></p>

<h4 id="测试-1">测试</h4>

<p>打开终端输入</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>ozone
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image51.webp" alt="" /></p>

<h3 id="下载svd">下载SVD</h3>

<p>https://www.st.com.cn/content/st_com/zh.html</p>

<p>在搜索里搜索芯片型号，如stm32f103c8t6</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image52.webp" alt="" /></p>

<p>点CAD资源</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image53.webp" alt="" /></p>

<p>下载SVD，鼠标点红色框的区域就可以下载了</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image54.webp" alt="" /></p>

<p>解压后就可以获得F1系列的SVD文件了</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image55.webp" alt="" /></p>

<p>依次把F4和H7的也下载解压了就可以了。（可以解压到一个文件夹里）</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image56.webp" alt="" /></p>

<p>然后在上面的文件夹打开终端</p>

<p>将这些文件夹全部复制到Ozone的<code class="language-plaintext highlighter-rouge">Config/Peripherals/</code>目录下。（你需要提前确定一下ozone的配置是否是这个路径再复制）</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image57.webp" alt="" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo cp</span> ./<span class="k">*</span>.svd /opt/SEGGER/Ozone_V338g/Config/Peripherals/
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image58.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image59.webp" alt="" /></p>

<h2 id="工程创建与测试">工程创建与测试</h2>

<h3 id="使用cubemx创建工程">使用CubeMX创建工程</h3>

<p>点击进入单片机挑选的按钮</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image60.webp" alt="" /></p>

<p>搜索对应芯片，并双击对应芯片选项。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image61.webp" alt="" /></p>

<p>进行一些配置，以下都是很基础的东西，你在看这个视频前肯定都会了</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image62.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image63.webp" alt="" /></p>

<p>随便开一个IO用来测试，比如LED的GPIO</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image64.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image65.webp" alt="" /></p>

<p>FreeRTOS也要配置一下。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image66.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image67.webp" alt="" /></p>

<p>这些文件夹也要配置好，最后Toolchain选择CMake,编译器选择GCC(6.14.1及之前没有选择编译器这个选项很正常)</p>

<p>（但是CubeMX6.15.0有bug,这个选择GCC编译器并没有用，还需要后续自己手动选择编译器，以后可能会修复这个bug.）</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image68.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image69.webp" alt="" /></p>

<h3 id="对工程进行配置与编译">对工程进行配置与编译</h3>

<p>在工程文件夹打开终端</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image70.webp" alt="" /></p>

<p>然后打开vscode</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>code <span class="nb">.</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image71.webp" alt="" /></p>

<p>进入vscode后，点击目录下的CMakeLists.txt</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image72.webp" alt="" /></p>

<p>检查第25行左右是否有下面这行，如果没有，你需要手动给他加上这两行。(6.14.1版本没有这个bug)</p>

<p><em>tips1：这就是上面说的CubeMX6.15.0版本的bug,因为这个版本增加了对clang编译器的支持，在CubeMX里也支持了选择编译器的操作，但是这个选项估计是工程师没写好，选择编译器不管选哪个，他都不会选择咱们选择的编译器，所以咱们需要手动选择。</em></p>

<p><em>tips2:这CubeMX6.15.0有第二个bug,这个工作区根CMakeLists.txt他说了只会生成一次，后续不会再重新覆盖生成，但是发现每次在CubeMX修改配置后，然后重新生成代码，其他命令都被保留了，就这个命令不会被保留。不知道后续会不会被修复，或者直接修复上面tips1的bug.所以每次重新配置CubeMX后，需要再把这句加上。</em></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image73.webp" alt="" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>
<span class="c"># Include toolchain file</span>
include<span class="o">(</span><span class="s2">"cmake/gcc-arm-none-eabi.cmake"</span><span class="o">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>按ctrl+～打开内置终端。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image74.webp" alt="" /></p>

<p>使用下方命令创建并进入build文件夹</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">mkdir </span>build
<span class="nb">cd </span>build
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image75.webp" alt="" /></p>

<p>接下来使用cmake命令生成makefile文件</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>cmake ..
</pre></td></tr></tbody></table></code></pre></div></div>

<p>检查一下是否ARM的C/C++以及汇编编译器都被找到了（如果没有，请检查上面的教程是否有做错的地方）</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image76.webp" alt="" /></p>

<p>然后使用make命令进行编译，命令为<code class="language-plaintext highlighter-rouge">make</code>或者<code class="language-plaintext highlighter-rouge">make -jxx</code>,这里的xx是你想使用CPU的几个线程来进行编译，比如我电脑是8核16线程，我就可以让xx是比16低的数字。而<code class="language-plaintext highlighter-rouge">make</code>是默认用一个线程。如果你并不知道你CPU有几个线程，那你就老老实实用<code class="language-plaintext highlighter-rouge">make</code>命令，别用<code class="language-plaintext highlighter-rouge">make -jxx</code>命令了。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>make <span class="nt">-j16</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>这样就是编译成功了。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image77.webp" alt="" /></p>

<h3 id="对代码提示进行配置">对代码提示进行配置</h3>

<p>在VScode中按Ctrl+Shift+P,搜索clangd,并选择下载语言服务</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image78.webp" alt="" /></p>

<p>在右下角选择安装即可，安装完就会出现下图提示。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image79.webp" alt="" /></p>

<p>接着禁用C/C++插件的代码提示功能(如果没这个界面，请往下看)</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image80.webp" alt="" /></p>

<p>如果没有上图的弹窗，可以进行手动关闭，依然是ctrl shift P,输入settings然后找到如下图的选项</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image81.webp" alt="" /></p>

<p>找到下图这个选项，改成disabled即可。</p>

<p><code class="language-plaintext highlighter-rouge">"C_Cpp.intelliSenseEngine": "disabled"</code></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image82.webp" alt="" /></p>

<p>在VScode中再按Ctrl+Shift+P,搜索clangd,并选择重启clangd语言服务(重启clangd语言服务之前必须编译过一遍代码了)</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image83.webp" alt="" /></p>

<p>此时，可以看代码里头文件都正常识别了,代码提示也正常了。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image84.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image85.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image86.webp" alt="" /></p>

<p>⚠️注意：Clangd 默认找的是 <strong>本机系统的 libc/include 路径（比如 x86_64 的 <code class="language-plaintext highlighter-rouge">/usr/include</code>）</strong> ，而我们工程里面实际使用的是 <strong>ARM 工具链的头文件路径</strong> ，这就有概率导致包含C/C++库函数的头文件报错</p>

<p>例如：</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image87.webp" alt="" /></p>

<p>这里的 #include <math.h>显示找不到头文件，但是我们进行编译的时候却没有报错，说明是clangd的配置有问题 。以下介绍一种解决方法：</math.h></p>

<ol>
  <li>运行以下命令，获取 ARM GCC 使用的标准 include 路径：</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>arm-none-eabi-gcc <span class="nt">-x</span> c <span class="nt">-E</span> <span class="nt">-v</span> - &lt;/dev/null
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image88.webp" alt="" /></p>

<ol>
  <li>在工程根目录下面创建 .clangd 文件 将自己的头文件路径包含进去（引号里面替换成你自己的arm gcc头文件路径）</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>CompileFlags:
  Add: [
    "-isystem", "/home/xiaofang/Applications/arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/lib/gcc/arm-none-eabi/14.3.1/include",
    "-isystem", "/home/xiaofang/Applications/arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/lib/gcc/arm-none-eabi/14.3.1/include-fixed",
    "-isystem", "/home/xiaofang/Applications/arm-gnu-toolchain-14.3.rel1-x86_64-arm-none-eabi/arm-none-eabi/include"
  ]
</pre></td></tr></tbody></table></code></pre></div></div>

<p>保存，此时刷新一下clangd,头文件提示正常</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image89.webp" alt="" /></p>

<h3 id="移植vinci机器人队标准cc工程模板">移植Vinci机器人队标准C/C++工程模板</h3>

<p>用git clone命令克隆仓库:https://github.com/tungchiahui/CubeMX_MDK5to6_Template</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>git clone https://github.com/tungchiahui/CubeMX_MDK5to6_Template.git
</pre></td></tr></tbody></table></code></pre></div></div>

<p>把仓库里的“工程文件移植”文件夹里的 <strong>所有内容</strong> 复制到我们CMake工程的目录里。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image90.webp" alt="" /></p>

<p>然后打开applications文件夹，在Src和Inc文件夹分别创建led_task.cpp和led_task.h，内容分别如下:</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image91.webp" alt="" /></p>

<p>led_task.cpp:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">"led_task.h"</span><span class="cp">
#include</span> <span class="cpf">"cmsis_os.h"</span><span class="cp">
#include</span> <span class="cpf">"stm32f1xx_hal.h"</span><span class="c1"> </span><span class="cp">
</span>
<span class="n">GPIO_PinState</span> <span class="n">pinstate</span> <span class="o">=</span> <span class="n">GPIO_PIN_RESET</span><span class="p">;</span>

<span class="k">extern</span> <span class="s">"C"</span>
<span class="kt">void</span> <span class="nf">StartDefaultTask</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">argument</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">for</span><span class="p">(;;)</span>
  <span class="p">{</span>
    <span class="n">HAL_GPIO_WritePin</span><span class="p">(</span><span class="n">GPIOC</span><span class="p">,</span><span class="n">GPIO_PIN_13</span><span class="p">,</span><span class="n">pinstate</span><span class="p">);</span>
    <span class="n">pinstate</span> <span class="o">=</span> <span class="p">(</span><span class="n">pinstate</span> <span class="o">==</span> <span class="n">GPIO_PIN_RESET</span><span class="p">)</span> <span class="o">?</span> <span class="n">GPIO_PIN_SET</span> <span class="o">:</span> <span class="n">GPIO_PIN_RESET</span><span class="p">;</span>
    <span class="n">osDelay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>led_task.h:</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="cp">#ifndef __LED_TASK_H_
#define __LED_TASK_H_
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="k">extern</span> <span class="s">"C"</span>
<span class="p">{</span>
<span class="cp">#endif
</span>
<span class="cp">#include</span> <span class="cpf">"cpp_interface.h"</span><span class="cp">
</span>
<span class="cp">#ifdef __cplusplus
</span><span class="p">}</span>
<span class="cp">#endif
</span>
<span class="cp">#endif
</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>然后打开<code class="language-plaintext highlighter-rouge">cmake/user</code>文件夹下的<code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>，把刚才新建的led_task.cpp添加上去。</p>

<p>详细介绍（可以不看）：这里的<code class="language-plaintext highlighter-rouge">cmake/stm32cubemx</code>下的<code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>是被CubeMX管理的，你重新用CubeMX生成新代码后，这个文件里的东西会被覆盖。而工作区根目录下的<code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>是不会被重新覆盖的，而且给我们留了一些区域加源文件和头文件，但是这样会让这个文件太过于嘈杂。所以我们选择新建一个user文件夹，然后在这里面弄一个<code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>，再用顶层<code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>去加载这个子<code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>，这个子<code class="language-plaintext highlighter-rouge">CMakeLists.txt</code>方便咱们修改，文件结构也更加明显。（这些都不需要咱们自己创建，我已经给创建到 <strong>工程文件移植</strong> 里了，你在上面复制的时候已经复制过来了）</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image92.webp" alt="" /></p>

<p>然后要去最顶层的CMakeLists.txt里加上这句话来引用我们自己的CMakeLists.txt。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image93.webp" alt="" /></p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>
<span class="c1"># Add USER generated sources</span>
<span class="nb">add_subdirectory</span><span class="p">(</span>cmake/user<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>大功告成，编译一次试试。可以看到下图，那些新加的文件都编译上了。</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">cmake</span> <span class="p">..</span>
<span class="n">make</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image94.webp" alt="" /></p>

<p>然后去main.c中引用cpp_interface.h头文件，并将cpp_main()函数在main函数的这个地方调用。(我这里是开RTOS了，所以需要在启动RTOS之前调用cpp_main函数，如果你是没有用RTOS的裸机程序，则在while (1)的上方调用cpp_main即可)</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image95.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image96.webp" alt="" /></p>

<p>然后在cpp_interface.h里修改isRTOS这个宏来让程序知道你是否开启了RTOS，如果开启了，宏就为1，裸机就填0。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image97.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image98.webp" alt="" /></p>

<p>其他更加详细的关于STM32的C/C++工程介绍请看<a href="https://sdutvincirobot.feishu.cn/wiki/PqsGwcPCuidbN6k13jfcGWtWn0b">Vinci机器人队单片机教程</a>。</p>

<p>此时在build文件夹下进行编译程序，发现成功!</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">cmake</span> <span class="p">..</span>
<span class="n">make</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image99.webp" alt="" /></p>

<h3 id="下载程序到板子">下载程序到板子</h3>

<h4 id="配置cmake生成bin和hex文件">配置CMake生成.bin和.hex文件</h4>

<p>在下载程序到板子之前，我们需要去看看咱们之前编译的到底生成了啥文件。</p>

<p>通过下图可知，他只生成了.elf文件，并没有咱们常见的.bin和.hex文件。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image100.webp" alt="" /></p>

<p>咱们需要再更改一下工作区下的CMakeLists.txt从而来让编译的时候生成.hex和.bin（没办法，就得这么麻烦，我也不知道为啥CubeMX不给全干好）</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image101.webp" alt="" /></p>

<div class="language-cmake highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>
<span class="c1"># 生成 .bin 和 .hex 文件</span>
<span class="nb">find_program</span><span class="p">(</span>OBJCOPY arm-none-eabi-objcopy REQUIRED<span class="p">)</span>

<span class="nb">add_custom_command</span><span class="p">(</span>TARGET <span class="si">${</span><span class="nv">CMAKE_PROJECT_NAME</span><span class="si">}</span> POST_BUILD
    COMMAND <span class="si">${</span><span class="nv">OBJCOPY</span><span class="si">}</span> -O binary <span class="si">${</span><span class="nv">CMAKE_PROJECT_NAME</span><span class="si">}</span>.elf <span class="si">${</span><span class="nv">CMAKE_PROJECT_NAME</span><span class="si">}</span>.bin
    COMMAND <span class="si">${</span><span class="nv">OBJCOPY</span><span class="si">}</span> -O ihex   <span class="si">${</span><span class="nv">CMAKE_PROJECT_NAME</span><span class="si">}</span>.elf <span class="si">${</span><span class="nv">CMAKE_PROJECT_NAME</span><span class="si">}</span>.hex
    COMMENT <span class="s2">"Generating </span><span class="si">${</span><span class="nv">CMAKE_PROJECT_NAME</span><span class="si">}</span><span class="s2">.bin and </span><span class="si">${</span><span class="nv">CMAKE_PROJECT_NAME</span><span class="si">}</span><span class="s2">.hex from </span><span class="si">${</span><span class="nv">CMAKE_PROJECT_NAME</span><span class="si">}</span><span class="s2">.elf"</span>
<span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>这些需要在工作区主CMakeLists.txt里添加的命令我全都写在这个记事本里了，每次生成新工程直接复制即可。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image102.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image103.webp" alt="" /></p>

<p>然后再次编译</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>cmake ..
make
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image104.webp" alt="" /></p>

<p>此时再看build目录：咱们需要的.hex或者.bin就出来了</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image105.webp" alt="" /></p>

<h4 id="将设备连接到jlink并烧录程序">将设备连接到JLink并烧录程序</h4>

<h5 id="图形界面烧录">图形界面烧录</h5>

<p>```Plain Text
#打开终端输入
JFlashLite</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre>
选择对应的芯片型号和速度

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image106.webp)

添加hex文件

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image107.webp)

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image108.webp)

点击烧录并完成：

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image109.webp)

成功点亮led：

![](https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image110.webp)

##### 终端烧录

算鸟算鸟，太麻烦了。

### 配置VScode任务

咱们在上面编译，一直需要输入以下命令

```cmake
cd build
cmake ..
make
</pre></td></tr></tbody></table></code></pre></div></div>

<p>这样每次编译过于麻烦了，所以我们使用强大的VScode来一键编译。</p>

<p>首先创建<code class="language-plaintext highlighter-rouge">.vscode</code>文件夹和<code class="language-plaintext highlighter-rouge">tasks.json</code>文件</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image111.webp" alt="" /></p>

<p>以下是<code class="language-plaintext highlighter-rouge">tasks.json</code>的内容：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2.0.0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"cwd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"${workspaceFolder}/build"</span><span class="w">    </span><span class="err">//需要进入到我们执行tasks任务的文件夹中</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"tasks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">    </span><span class="err">//tasks包含</span><span class="mi">4</span><span class="err">个任务</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"shell"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stm32-cmake"</span><span class="p">,</span><span class="w">    </span><span class="err">//第一个任务的名字叫cmake</span><span class="w">
            </span><span class="nl">"command"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bash"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"-c"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"mkdir -p ../log &amp;&amp; echo </span><span class="se">\"</span><span class="s2">===== CMake started at: $(date) =====</span><span class="se">\"</span><span class="s2"> | tee -a ../log/cmake.log &amp;&amp; cmake .. 2&gt;&amp;1 | tee -a ../log/cmake.log"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"problemMatcher"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">    </span><span class="err">//这里需要添加一个空的问题匹配器，否则会报错</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stm32-make"</span><span class="p">,</span><span class="w">    </span><span class="err">//第二个任务的名字叫make</span><span class="w">
            </span><span class="nl">"command"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bash"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"-c"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"mkdir -p ../log &amp;&amp; echo </span><span class="se">\"</span><span class="s2">===== Make started at: $(date) =====</span><span class="se">\"</span><span class="s2"> | tee -a ../log/make.log &amp;&amp; make -j$(grep -c ^processor /proc/cpuinfo) 2&gt;&amp;1 | tee -a ../log/make.log"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"problemMatcher"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">    </span><span class="err">//这里也需要添加一个空的问题匹配器，否则会报错</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stm32-Build"</span><span class="p">,</span><span class="w">    </span><span class="err">//第</span><span class="mi">3</span><span class="err">个任务的名字叫Build</span><span class="w">
            </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">               </span><span class="err">//默认是build任务</span><span class="w">
                </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"build"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"isDefault"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"dependsOrder"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sequence"</span><span class="p">,</span><span class="w">    </span><span class="err">//顺序执行依赖项</span><span class="w">
            </span><span class="nl">"dependsOn"</span><span class="p">:[</span><span class="w">    </span><span class="err">//依赖的</span><span class="mi">2</span><span class="err">个项为cmake、make</span><span class="w">
                </span><span class="s2">"stm32-cmake"</span><span class="p">,</span><span class="w">    </span><span class="err">//即第一个任务的label</span><span class="w">
                </span><span class="s2">"stm32-make"</span><span class="w">      </span><span class="err">//即第二个任务的label</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"shell"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stm32-clean"</span><span class="p">,</span><span class="w">    </span><span class="err">//第四个任务：清理</span><span class="w"> </span><span class="err">build</span><span class="w"> </span><span class="err">文件夹</span><span class="w">
            </span><span class="nl">"command"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bash"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"args"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"-c"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"echo </span><span class="se">\"</span><span class="s2">===== Clean started at: $(date) =====</span><span class="se">\"</span><span class="s2"> &amp;&amp; rm -rf * &amp;&amp; echo </span><span class="se">\"</span><span class="s2">Build folder cleaned.</span><span class="se">\"</span><span class="s2">"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"cwd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"${workspaceFolder}/build"</span><span class="w">    </span><span class="err">//只清理build目录下的文件</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"problemMatcher"</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="w">    </span><span class="err">//不需要问题匹配器</span><span class="w">
        </span><span class="p">}</span><span class="w">

    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>方法一：</strong></p>

<p>在VScode标题栏上，找到<code class="language-plaintext highlighter-rouge">终端</code>，然后再选择<code class="language-plaintext highlighter-rouge">运行构建任务</code>，快捷键是<code class="language-plaintext highlighter-rouge">Ctrl+Shift+B</code>。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image112.webp" alt="" /></p>

<p>可见任务已经被运行了。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image113.webp" alt="" /></p>

<p><strong>方法二：</strong></p>

<p>在VScode标题栏上，找到<code class="language-plaintext highlighter-rouge">终端</code>，然后再选择<code class="language-plaintext highlighter-rouge">运行任务</code>。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image114.webp" alt="" /></p>

<p>下面有4个stm32的任务，第一个是<code class="language-plaintext highlighter-rouge">stm32-Build</code>任务，运行后的效果和刚才方法一是一样的，方法一的那个<code class="language-plaintext highlighter-rouge">运行构建任务</code>的按钮，就是运行的这个<code class="language-plaintext highlighter-rouge">stm32-Build</code>任务。</p>

<p>这个<code class="language-plaintext highlighter-rouge">stm32-Build</code>任务包含stm32-cmake和stm32-make任务。</p>

<p>然后<code class="language-plaintext highlighter-rouge">stm32-clean</code>任务就是清除build文件夹下的所有文件。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image115.webp" alt="" /></p>

<p>可以试一下<code class="language-plaintext highlighter-rouge">stm32-clean</code>任务。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image116.webp" alt="" /></p>

<p>可以发现都删完了。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image117.webp" alt="" /></p>

<p><strong>你不用担心每次新建工程都需要配置那么多东西。</strong></p>

<p>以上大多数配置文件全部都已经包含在https://github.com/tungchiahui/CubeMX_MDK5to6_Template仓库下的<strong><em><code class="language-plaintext highlighter-rouge">工程文件移植(创建新模板请看这里)</code></em></strong>文件夹了，到时候新建一个工程后，直接把这个文件夹下的所有文件全部复制过来即可。</p>

<h3 id="使用ozone进行flash烧录和debug调试">使用ozone进行Flash烧录和Debug调试</h3>

<h4 id="基础配置">基础配置</h4>

<p>打开终端输入ozone打开软件或者直接找到应用图标打开ozone</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image118.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image119.webp" alt="" /></p>

<p>先选择device，比如我是STM32F407VET6</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image120.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image121.webp" alt="" /></p>

<p>选择Peripherals:</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image122.webp" alt="" /></p>

<p>点击下一步</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image123.webp" alt="" /></p>

<p>你用的SWD就填SWD，是JTAG就填JTAG</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image124.webp" alt="" /></p>

<p>选择ELF</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image125.webp" alt="" /></p>

<p>elf,hex,bin都可以选，一般选elf就行。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image126.webp" alt="" /></p>

<p>这一步保持默认即可。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image127.webp" alt="" /></p>

<p>如果你开启了RTOS可能会遇到这个问题。</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>warning <span class="o">(</span>138<span class="o">)</span>: The target application seems to be using FreeRTOS, but FreeRTOS-awareness is not enabled.
</pre></td></tr></tbody></table></code></pre></div></div>

<p>意思是你的目标应用似乎使用了 FreeRTOS，但当前没有启用对 FreeRTOS 的调试支持（RTOS-awareness）。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image128.webp" alt="" /></p>

<p>直接按照他底下的提示应用修复即可。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image129.webp" alt="" /></p>

<p>点继续就行。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image130.webp" alt="" /></p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image131.webp" alt="" /></p>

<h4 id="烧录与调试">烧录与调试</h4>

<p>可以看下面这个视频，讲的挺好的。<strong>(从30:10开始看）</strong></p>

<p>https://www.bilibili.com/video/BV1yrLHzZEoE</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image132.webp" alt="" /></p>

<p>点击File让他按文件名排序。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image133.webp" alt="" /></p>

<p>找到led_task.cpp点击就可以打开这个源文件啦。</p>

<p><img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/2025-07-18/image134.webp" alt="" /></p>

<h1 id="windows">Windows</h1>

<h2 id="环境准备">环境准备</h2>

<p>本教程环境介绍：</p>

<ol>
  <li>
    <p>系统：Windows 11 LSTC</p>
  </li>
  <li>
    <p>系统内核：Windows NT</p>
  </li>
  <li>
    <p>架构：X86_64</p>
  </li>
</ol>

<p>算鸟算鸟，肝部东啦</p>

  </div>
</article>

<script>
// 页面内容加载完成后执行
document.addEventListener("DOMContentLoaded", function() {

  const imgs = document.querySelectorAll('.post-content img');

  imgs.forEach(img => {
    // 如果图片还没有 data-src，就把 src 移过去
    if (!img.dataset.src) {
      img.dataset.src = img.src; 
      img.removeAttribute('src'); 
    }
  });

  const observer = new IntersectionObserver((entries, obs) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const img = entry.target;

        if (img.dataset.src) {
          img.src = img.dataset.src;
          img.removeAttribute('data-src');

          // ✅ 新增：当图片真正加载完成后，触发自定义事件
          img.addEventListener('load', () => {
            const event = new CustomEvent('lazyloaded', { detail: { img } });
            document.dispatchEvent(event);
          }, { once: true });
        }

        obs.unobserve(img);
      }
    });
  }, {
    root: null,           
    rootMargin: '666px 0px',
    threshold: 0          
  });

  imgs.forEach(img => observer.observe(img));
});
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  document.querySelectorAll('div[class*="language-"].highlighter-rouge').forEach((highlightDiv) => {
    const codePre = highlightDiv.querySelector('td.rouge-code pre');
    if (!codePre) return;

    // 创建复制按钮
    const button = document.createElement('button');
    button.className = 'copy-button';
    button.type = 'button';
    button.innerText = '复制';

    button.addEventListener('click', () => {
      const text = codePre.innerText.trim();
      navigator.clipboard.writeText(text).then(() => {
        button.innerText = '已复制';
        setTimeout(() => button.innerText = '复制', 2000);
      });
    });

    // 挂到 highlightDiv 上，保证按钮固定在代码框右上角
    highlightDiv.style.position = 'relative';   // 父容器相对定位
    button.style.position = 'absolute';
    button.style.top = '8px';
    button.style.right = '8px';
    button.style.padding = '4px 8px';
    button.style.fontSize = '0.8em';
    button.style.cursor = 'pointer';

    highlightDiv.appendChild(button);
  });
});
</script>

<!-- === 图片点击放大效果 === -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  // 选择文章正文内所有图片
  const images = document.querySelectorAll('.post-content img');

  // 过滤掉代码块或表格中不需要放大的图片
  const validImages = Array.from(images).filter(img => {
    return !img.closest('pre, code, table');
  });

  // 初始化 Medium Zoom
  const zoom = mediumZoom(validImages, {
    margin: 24, // 放大时边距
    background: 'rgba(0,0,0,0.8)', // 背景遮罩色
    scrollOffset: 40 // 滚动多少距离后关闭放大
  });

  // 如果页面启用了懒加载，当懒加载触发时重新绑定放大事件
  document.addEventListener('lazyloaded', () => {
    zoom.detach(); // 先解除旧绑定
    zoom.attach('.post-content img'); // 重新绑定新加载的图片
  });
});
</script>




    </main>

    <footer>
  <p>© 2025 小辉的折腾天地. All rights reserved.</p>

  <!-- 社交图标 -->
  <div class="footer-social">
    
      <a href="https://me.tungchiahui.cn" target="_blank" rel="noopener" title="Website">
        <i class="fas fa-link"></i>
      </a>
    
    
      <a href="mailto:tungchiahui@gmail.com" target="_blank" rel="noopener" title="E-Mail">
        <i class="fas fa-envelope"></i>
      </a>
    
    
      <a href="https://github.com/tungchiahui" target="_blank" rel="noopener" title="GitHub">
        <i class="fab fa-github"></i>
      </a>
    
    
      <a href="https://qm.qq.com/q/JRhksaNK82?from=qq" target="_blank" rel="noopener" title="QQ">
        <i class="fab fa-qq"></i>
      </a>
    
    
      <a href="https://t.me/tungchiahui" target="_blank" rel="noopener" title="Telegram">
        <i class="fab fa-telegram"></i>
      </a>
    
    
      <a href="http://www.coolapk.com/u/3224578" target="_blank" rel="noopener" title="CoolAPK">
        <i class="fab fa-android"></i>
      </a>
    
    
      <a href="https://space.bilibili.com/141482453" target="_blank" rel="noopener" title="Bilibili">
        <i class="fa-brands fa-bilibili"></i>
      </a>
    
    
      <a href="https://www.youtube.com/@Chia-huiTung" target="_blank" rel="noopener" title="YouTube">
        <i class="fab fa-youtube"></i>
      </a>
    
    
      <a href="https://twitter.com/tungchiahui" target="_blank" rel="noopener" title="Twitter">
        <i class="fab fa-twitter"></i>
      </a>
    
    
      <a href="https://www.facebook.com/tungchiahui" target="_blank" rel="noopener" title="Facebook">
        <i class="fab fa-facebook"></i>
      </a>
    
    
      <a href="https://www.instagram.com/tungchiahui" target="_blank" rel="noopener" title="Instagram">
        <i class="fab fa-instagram"></i>
      </a>
    
  </div>

  <div class="footer-records">
    <!-- ICP 备案号 -->
    
    <a href="https://beian.miit.gov.cn/" target="_blank" rel="noopener" class="footer-record icp">
      <img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/footer/favicon-miit.ico" alt="工信部图标">
      鲁ICP备2025185601号-2
    </a>
    

     <!-- 公安备案号 -->
    
    <a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=xxxxxxxxxxx" target="_blank" rel="noopener" class="footer-record beian">
      <img src="https://cdn.tungchiahui.cn/tungwebsite/assets/images/footer/favicon-mps.ico" alt="公安备案图标">
      鲁公网安备 xxxxxxxxxxx 号
    </a>
    
  </div>


</footer>


    <!-- 这才是liquild的注释，不能用html的注释 -->
    <!-- 因为liquid会把html的注释也渲染出来 -->
    

  </body>
</html>
